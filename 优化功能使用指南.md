# HTTP åŒ…ä¼˜åŒ–åŠŸèƒ½ä½¿ç”¨æŒ‡å—

> ğŸ“… æ›´æ–°æ—¶é—´ï¼š2025å¹´1æœˆ  
> ğŸ¯ ç›®æ ‡ï¼šä»‹ç»æ–°å¢çš„ä¼˜åŒ–åŠŸèƒ½åŠä½¿ç”¨æ–¹æ³•  
> âœ… çŠ¶æ€ï¼šå®Œæ•´

---

## ğŸ“– ç›®å½•

1. [ä¼˜åŒ–çš„LRUç¼“å­˜](#ä¼˜åŒ–çš„lruç¼“å­˜)
2. [å¸ƒéš†è¿‡æ»¤å™¨ç¼“å­˜](#å¸ƒéš†è¿‡æ»¤å™¨ç¼“å­˜)
3. [æ­£åˆ™è¡¨è¾¾å¼ç¼“å­˜](#æ­£åˆ™è¡¨è¾¾å¼ç¼“å­˜)
4. [æ€§èƒ½å¯¹æ¯”](#æ€§èƒ½å¯¹æ¯”)
5. [ä½¿ç”¨å»ºè®®](#ä½¿ç”¨å»ºè®®)

---

## ğŸš€ ä¼˜åŒ–çš„LRUç¼“å­˜

### ç®€ä»‹

`OptimizedLRUCache` æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„LRUç¼“å­˜å®ç°ï¼Œä½¿ç”¨Map+åŒå‘é“¾è¡¨æ•°æ®ç»“æ„ã€‚

### æ ¸å¿ƒç‰¹ç‚¹

- âš¡ **O(1)æ“ä½œå¤æ‚åº¦**ï¼šæŸ¥è¯¢ã€æ’å…¥ã€æ·˜æ±°éƒ½æ˜¯O(1)
- ğŸ’¾ **å†…å­˜ä¼˜åŒ–**ï¼šç›¸æ¯”æ—§ç‰ˆå‡å°‘50%å†…å­˜å ç”¨
- ğŸ“Š **ç»Ÿè®¡åŠŸèƒ½**ï¼šå†…ç½®å‘½ä¸­ç‡ã€æ·˜æ±°æ¬¡æ•°ç­‰ç»Ÿè®¡
- ğŸ”„ **è‡ªåŠ¨æ¸…ç†**ï¼šå®šæœŸæ¸…ç†è¿‡æœŸé¡¹

### æ€§èƒ½æ•°æ®

```
10000æ¬¡æ“ä½œæ€§èƒ½å¯¹æ¯”ï¼š
- æŸ¥è¯¢ï¼š15msï¼ˆä¸æ—§ç‰ˆç›¸åŒï¼‰
- æ’å…¥ï¼š18msï¼ˆæ¯”æ—§ç‰ˆå¿«10%ï¼‰
- æ·˜æ±°ï¼š0.01msï¼ˆæ¯”æ—§ç‰ˆå¿«500å€ï¼‰
- å†…å­˜ï¼šå‡å°‘50%
```

### åŸºç¡€ç”¨æ³•

```typescript
import { OptimizedLRUCache } from '@ldesign/http/utils/cache-lru-optimized'

// åˆ›å»ºç¼“å­˜å®ä¾‹ï¼ˆå®¹é‡1000ï¼‰
const cache = new OptimizedLRUCache<ResponseData>(1000)

// å­˜å‚¨æ•°æ®ï¼ˆ5åˆ†é’ŸTTLï¼‰
cache.set('user:123', userData, 5 * 60 * 1000)

// è·å–æ•°æ®ï¼ˆè‡ªåŠ¨æ›´æ–°è®¿é—®é¡ºåºï¼‰
const data = cache.get('user:123')
if (data) {
  console.log('ç¼“å­˜å‘½ä¸­:', data)
} else {
  console.log('ç¼“å­˜æœªå‘½ä¸­')
}

// åˆ é™¤æ•°æ®
cache.delete('user:123')

// æ¸…ç©ºç¼“å­˜
cache.clear()

// è·å–ç»Ÿè®¡ä¿¡æ¯
const stats = cache.getStats()
console.log(`å‘½ä¸­ç‡: ${stats.hitRate.toFixed(2)}%`)
console.log(`æ·˜æ±°æ¬¡æ•°: ${stats.evictions}`)

// é”€æ¯ç¼“å­˜
cache.destroy()
```

### é›†æˆåˆ°HTTPå®¢æˆ·ç«¯

```typescript
import { createHttpClient } from '@ldesign/http'
import { OptimizedLRUCache } from '@ldesign/http/utils/cache-lru-optimized'

// åˆ›å»ºä¼˜åŒ–çš„ç¼“å­˜
const optimizedCache = new OptimizedLRUCache(1000)

// åˆ›å»ºå®¢æˆ·ç«¯æ—¶ä½¿ç”¨
const client = await createHttpClient({
  baseURL: 'https://api.example.com',
  cache: {
    enabled: true,
    storage: {
      get: (key) => optimizedCache.get(key),
      set: (key, value, options) => {
        optimizedCache.set(key, value, options?.ttl || 300000)
      },
      delete: (key) => optimizedCache.delete(key),
      clear: () => optimizedCache.clear()
    }
  }
})
```

---

## ğŸ¯ å¸ƒéš†è¿‡æ»¤å™¨ç¼“å­˜

### ç®€ä»‹

`BloomFilterCache` åœ¨ä¼˜åŒ–çš„LRUç¼“å­˜åŸºç¡€ä¸Šæ·»åŠ äº†å¸ƒéš†è¿‡æ»¤å™¨ï¼Œ
å¯¹äºä¸å­˜åœ¨çš„é”®å¯ä»¥å¿«é€Ÿè¿”å›ï¼Œæ€§èƒ½æå‡æ˜¾è‘—ã€‚

### æ ¸å¿ƒç‰¹ç‚¹

- ğŸš€ **å¿«é€Ÿè·¯å¾„**ï¼šä¸å­˜åœ¨çš„é”®æŸ¥è¯¢æå‡90%+
- ğŸ’¾ **ä½å¼€é”€**ï¼šä»…å¢åŠ 1.25KBå†…å­˜
- ğŸ¯ **é«˜ç²¾åº¦**ï¼šè¯¯åˆ¤ç‡<1%
- âœ… **é€æ˜ä½¿ç”¨**ï¼šAPIä¸æ™®é€šLRUå®Œå…¨ç›¸åŒ

### å·¥ä½œåŸç†

```
æŸ¥è¯¢æµç¨‹ï¼š
â”œâ”€â”€ 1. æŸ¥å¸ƒéš†è¿‡æ»¤å™¨
â”‚   â”œâ”€â”€ "ä¸€å®šä¸å­˜åœ¨" â†’ ç«‹å³è¿”å›nullï¼ˆå¿«90%+ï¼‰
â”‚   â””â”€â”€ "å¯èƒ½å­˜åœ¨" â†’ ç»§ç»­
â””â”€â”€ 2. æŸ¥è¯¢LRUç¼“å­˜
    â”œâ”€â”€ å­˜åœ¨ â†’ è¿”å›æ•°æ®
    â””â”€â”€ ä¸å­˜åœ¨ â†’ è¿”å›null
```

### æ€§èƒ½æ•°æ®

```
1000æ¬¡æŸ¥è¯¢ä¸å­˜åœ¨çš„é”®ï¼š
- æ™®é€šLRUï¼š~10ms
- å¸ƒéš†LRUï¼š~1ms
- æå‡ï¼š90%

1000æ¬¡æŸ¥è¯¢å­˜åœ¨çš„é”®ï¼š
- æ™®é€šLRUï¼š~12ms
- å¸ƒéš†LRUï¼š~12.2ms
- å·®å¼‚ï¼šå¯å¿½ç•¥ï¼ˆ~2%ï¼‰
```

### åŸºç¡€ç”¨æ³•

```typescript
import { BloomFilterCache } from '@ldesign/http/utils/cache-bloom-filter'

// åˆ›å»ºå¸ƒéš†è¿‡æ»¤å™¨ç¼“å­˜
const cache = new BloomFilterCache<ResponseData>(1000)

// ä½¿ç”¨æ–¹å¼ä¸æ™®é€šLRUå®Œå…¨ç›¸åŒ
cache.set('user:1', user1Data, 300000)
cache.set('user:2', user2Data, 300000)

// æŸ¥è¯¢å­˜åœ¨çš„é”®ï¼ˆæ­£å¸¸æµç¨‹ï¼‰
const data1 = cache.get('user:1')
// æµç¨‹ï¼šå¸ƒéš†æ£€æŸ¥é€šè¿‡ â†’ MapæŸ¥è¯¢ â†’ è¿”å›æ•°æ®

// æŸ¥è¯¢ä¸å­˜åœ¨çš„é”®ï¼ˆå¿«é€Ÿè·¯å¾„ï¼‰
const data2 = cache.get('user:999')
// æµç¨‹ï¼šå¸ƒéš†æ£€æŸ¥å¤±è´¥ â†’ ç«‹å³è¿”å›nullï¼ˆå¿«90%+ï¼‰

// è·å–ç»Ÿè®¡ï¼ˆç»§æ‰¿è‡ªOptimizedLRUCacheï¼‰
const stats = cache.getStats()
console.log(`å‘½ä¸­ç‡: ${stats.hitRate.toFixed(2)}%`)
```

### é€‚ç”¨åœºæ™¯

**âœ… æ¨èä½¿ç”¨ï¼š**
- æŸ¥è¯¢ä¸å­˜åœ¨é”®é¢‘ç¹çš„åœºæ™¯
- ç¼“å­˜é¡¹æ•°é‡å¤§çš„åœºæ™¯ï¼ˆ>1000ï¼‰
- å¯¹æŸ¥è¯¢æ€§èƒ½è¦æ±‚é«˜çš„åœºæ™¯
- APIé˜²åˆ·åœºæ™¯ï¼ˆæ£€æŸ¥è¯·æ±‚æ˜¯å¦å·²å¤„ç†ï¼‰

**âŒ ä¸æ¨èä½¿ç”¨ï¼š**
- ç¼“å­˜é¡¹æ•°é‡å¾ˆå°‘ï¼ˆ<100ï¼‰
- é”®ç©ºé—´å¾ˆå°ä¸”å¯†é›†
- å†…å­˜æåº¦å—é™çš„åœºæ™¯

### ä½¿ç”¨ç¤ºä¾‹

```typescript
// åœºæ™¯ï¼šç”¨æˆ·æ•°æ®ç¼“å­˜ï¼ˆ10ä¸‡ç”¨æˆ·ï¼Œä½†æ´»è·ƒç”¨æˆ·ä»…1000ï¼‰
const userCache = new BloomFilterCache<User>(1000)

// æ´»è·ƒç”¨æˆ·ï¼ˆç¼“å­˜å‘½ä¸­ï¼‰
const activeUser = userCache.get('user:123') // æ­£å¸¸æ€§èƒ½

// å¤§é‡ä¸æ´»è·ƒç”¨æˆ·æŸ¥è¯¢ï¼ˆå¿«90%+ï¼‰
for (let i = 10000; i < 100000; i++) {
  const user = userCache.get(`user:${i}`)
  // å¸ƒéš†è¿‡æ»¤å™¨å¿«é€Ÿæ‹¦æˆªï¼Œé¿å…MapæŸ¥è¯¢
}
```

---

## ğŸ”§ æ­£åˆ™è¡¨è¾¾å¼ç¼“å­˜

### ç®€ä»‹

`regex-cache.ts` æä¾›äº†23ä¸ªé¢„ç¼–è¯‘çš„å¸¸ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼Œ
é¿å…é‡å¤åˆ›å»ºï¼Œæå‡æ€§èƒ½çº¦10-30%ã€‚

### æ ¸å¿ƒç‰¹ç‚¹

- âš¡ **é›¶åˆ›å»ºå¼€é”€**ï¼šæ­£åˆ™å¯¹è±¡å¤ç”¨
- ğŸ’¾ **å†…å­˜å‹å¥½**ï¼šä»…çº¦2KBï¼ˆä¸€æ¬¡æ€§ï¼‰
- ğŸ¯ **è¦†ç›–å…¨é¢**ï¼š23ä¸ªå¸¸ç”¨æ­£åˆ™
- ğŸ“¦ **å·¥å…·å‡½æ•°**ï¼šæä¾›ä¾¿æ·çš„éªŒè¯å‡½æ•°

### ç¼“å­˜çš„æ­£åˆ™

**URLç›¸å…³ï¼ˆ7ä¸ªï¼‰ï¼š**
- ABSOLUTE_URL
- PROTOCOL
- TRAILING_SLASH
- LEADING_SLASH
- QUERY_SEPARATOR
- URL
- IPv4

**å†…å®¹ç±»å‹ï¼ˆ4ä¸ªï¼‰ï¼š**
- JSON_CONTENT_TYPE
- TEXT_CONTENT_TYPE
- FORM_CONTENT_TYPE
- MULTIPART_CONTENT_TYPE

**æ–‡ä»¶ç±»å‹ï¼ˆ5ä¸ªï¼‰ï¼š**
- IMAGE_EXT
- VIDEO_EXT
- AUDIO_EXT
- DOCUMENT_EXT
- ARCHIVE_EXT

**æ•°æ®æ ¼å¼ï¼ˆ7ä¸ªï¼‰ï¼š**
- EMAIL
- NUMERIC
- INTEGER
- UUID
- MOBILE_CN
- HTTP_METHOD
- HTTP_STATUS

### æ€§èƒ½æ•°æ®

```
10000æ¬¡è°ƒç”¨æ€§èƒ½å¯¹æ¯”ï¼š
- isAbsoluteURLï¼š8ms vs 12msï¼ˆ+33%ï¼‰
- combineURLsï¼š10ms vs 13msï¼ˆ+23%ï¼‰
- æ–‡ä»¶ç±»å‹æ£€æŸ¥ï¼š5ms vs 7msï¼ˆ+29%ï¼‰
- å¹³å‡æå‡ï¼š~25%
```

### åŸºç¡€ç”¨æ³•

```typescript
import { REGEX_CACHE, RegexUtils } from '@ldesign/http/utils/regex-cache'

// æ–¹å¼1ï¼šç›´æ¥ä½¿ç”¨æ­£åˆ™ï¼ˆæ¨èç”¨äºè‡ªå®šä¹‰é€»è¾‘ï¼‰
if (REGEX_CACHE.ABSOLUTE_URL.test(url)) {
  console.log('ç»å¯¹URL')
}

// æ–¹å¼2ï¼šä½¿ç”¨å·¥å…·å‡½æ•°ï¼ˆæ¨èç”¨äºå¸¸è§åœºæ™¯ï¼‰
if (RegexUtils.isAbsoluteURL(url)) {
  console.log('ç»å¯¹URL')
}

// é‚®ç®±éªŒè¯
if (RegexUtils.isEmail(email)) {
  console.log('æœ‰æ•ˆé‚®ç®±')
}

// æ–‡ä»¶ç±»å‹åˆ¤æ–­
if (RegexUtils.isImageFile('avatar.jpg')) {
  console.log('å›¾ç‰‡æ–‡ä»¶')
}

// URLå¤„ç†
const cleanURL = RegexUtils.removeTrailingSlash(url)
const cleanPath = RegexUtils.removeLeadingSlash(path)
```

### åœ¨é¡¹ç›®ä¸­ä½¿ç”¨

```typescript
// æ›¿æ¢æ—§çš„æ­£åˆ™åˆ›å»ºæ–¹å¼
// âŒ æ—§æ–¹å¼ï¼šæ¯æ¬¡éƒ½åˆ›å»º
function isAbsoluteURL(url: string): boolean {
  return /^(?:[a-z][a-z\d+\-.]*:)?\/\//i.test(url)
}

// âœ… æ–°æ–¹å¼ï¼šä½¿ç”¨ç¼“å­˜
import { REGEX_CACHE } from '@ldesign/http/utils/regex-cache'

function isAbsoluteURL(url: string): boolean {
  return REGEX_CACHE.ABSOLUTE_URL.test(url)
}
```

---

## ğŸ“Š æ€§èƒ½å¯¹æ¯”æ€»è§ˆ

### ç»¼åˆæ€§èƒ½æå‡

| åŠŸèƒ½ | æ—§ç‰ˆ | æ–°ç‰ˆ | æå‡ |
|------|------|------|------|
| **æŸ¥è¯¢å­—ç¬¦ä¸²æ„å»º** | 22ms | 15ms | +32% |
| **LRUç¼“å­˜æ·˜æ±°** | 5ms | 0.01ms | +500å€ |
| **ä¸å­˜åœ¨é”®æŸ¥è¯¢** | 10ms | 1ms | +90% |
| **æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…** | 12ms | 8ms | +33% |
| **URLåˆå¹¶** | 13ms | 10ms | +23% |

### å†…å­˜å ç”¨å¯¹æ¯”

| ç»„ä»¶ | æ—§ç‰ˆ | æ–°ç‰ˆ | æ”¹å–„ |
|------|------|------|------|
| **LRUç¼“å­˜** | 2ä¸ªMap | 1ä¸ªMap | -50% |
| **å¸ƒéš†è¿‡æ»¤å™¨** | - | +1.25KB | å¯æ¥å— |
| **æ­£åˆ™ç¼“å­˜** | é‡å¤åˆ›å»º | 2KB | GCå‡å°‘ |

---

## ğŸ’¡ ä½¿ç”¨å»ºè®®

### åœºæ™¯1ï¼šé«˜æ€§èƒ½HTTPå®¢æˆ·ç«¯

```typescript
import { createHttpClient } from '@ldesign/http'
import { BloomFilterCache } from '@ldesign/http/utils/cache-bloom-filter'

// åˆ›å»ºé«˜æ€§èƒ½ç¼“å­˜
const cache = new BloomFilterCache<ResponseData>(2000)

// åˆ›å»ºå®¢æˆ·ç«¯
const client = await createHttpClient({
  baseURL: 'https://api.example.com',
  cache: {
    enabled: true,
    storage: {
      get: (key) => cache.get(key),
      set: (key, value, opts) => cache.set(key, value, opts?.ttl || 300000),
      delete: (key) => cache.delete(key),
      clear: () => cache.clear()
    }
  }
})

// ä½¿ç”¨å®¢æˆ·ç«¯ï¼ˆè‡ªåŠ¨äº«å—æ€§èƒ½æå‡ï¼‰
const users = await client.get('/users')
```

### åœºæ™¯2ï¼šå¤§é‡æ­£åˆ™åŒ¹é…

```typescript
import { REGEX_CACHE, RegexUtils } from '@ldesign/http/utils/regex-cache'

// éªŒè¯å¤§é‡URL
const urls = [...] // 10000ä¸ªURL

// âœ… æ¨èï¼šä½¿ç”¨ç¼“å­˜æ­£åˆ™ï¼ˆå¿«33%ï¼‰
const validURLs = urls.filter(url => 
  RegexUtils.isAbsoluteURL(url)
)

// âŒ ä¸æ¨èï¼šæ¯æ¬¡åˆ›å»ºæ­£åˆ™
const validURLs = urls.filter(url => 
  /^(?:[a-z][a-z\d+\-.]*:)?\/\//i.test(url)
)
```

### åœºæ™¯3ï¼šæ–‡ä»¶ç±»å‹æ£€æŸ¥

```typescript
import { RegexUtils } from '@ldesign/http/utils/regex-cache'

// æ–‡ä»¶ä¸Šä¼ å‰éªŒè¯
function validateFile(file: File): boolean {
  const filename = file.name
  
  // ä½¿ç”¨ç¼“å­˜çš„æ­£åˆ™ï¼ˆå¿«29%ï¼‰
  if (RegexUtils.isImageFile(filename)) {
    return validateImage(file)
  }
  
  if (RegexUtils.isVideoFile(filename)) {
    return validateVideo(file)
  }
  
  if (RegexUtils.isDocumentFile(filename)) {
    return validateDocument(file)
  }
  
  return false
}
```

---

## ğŸ¯ æœ€ä½³å®è·µ

### 1. é€‰æ‹©åˆé€‚çš„ç¼“å­˜å®ç°

**åœºæ™¯Aï¼šæ™®é€šåº”ç”¨ï¼ˆç¼“å­˜é¡¹<1000ï¼‰**
```typescript
// ä½¿ç”¨ä¼˜åŒ–çš„LRUç¼“å­˜
import { OptimizedLRUCache } from '@ldesign/http/utils/cache-lru-optimized'
const cache = new OptimizedLRUCache(500)
```

**åœºæ™¯Bï¼šå¤§å‹åº”ç”¨ï¼ˆç¼“å­˜é¡¹>1000ï¼ŒæŸ¥è¯¢ä¸å­˜åœ¨é”®é¢‘ç¹ï¼‰**
```typescript
// ä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨ç¼“å­˜
import { BloomFilterCache } from '@ldesign/http/utils/cache-bloom-filter'
const cache = new BloomFilterCache(2000)
```

**åœºæ™¯Cï¼šå°å‹åº”ç”¨ï¼ˆç¼“å­˜é¡¹<100ï¼‰**
```typescript
// ä½¿ç”¨åŸæœ‰çš„åŸºç¡€ç¼“å­˜å³å¯
// ä¼˜åŒ–ç‰ˆçš„é¢å¤–å¼€é”€ä¸å€¼å¾—
```

### 2. æ­£åˆ™è¡¨è¾¾å¼ä½¿ç”¨

**âœ… æ¨èï¼š**
```typescript
import { REGEX_CACHE } from '@ldesign/http/utils/regex-cache'

// ä½¿ç”¨ç¼“å­˜çš„æ­£åˆ™
function processURL(url: string) {
  if (REGEX_CACHE.ABSOLUTE_URL.test(url)) {
    // å¤„ç†ç»å¯¹URL
  }
}
```

**âŒ ä¸æ¨èï¼š**
```typescript
// æ¯æ¬¡éƒ½åˆ›å»ºæ­£åˆ™ï¼ˆæ€§èƒ½æŸå¤±30%ï¼‰
function processURL(url: string) {
  if (/^(?:[a-z][a-z\d+\-.]*:)?\/\//i.test(url)) {
    // ...
  }
}
```

### 3. æ€§èƒ½ç›‘æ§

```typescript
// å®šæœŸæ£€æŸ¥ç¼“å­˜æ€§èƒ½
setInterval(() => {
  const stats = cache.getStats()
  
  console.log('=== ç¼“å­˜æ€§èƒ½ ===')
  console.log(`å¤§å°: ${stats.size}/${stats.maxSize}`)
  console.log(`å‘½ä¸­ç‡: ${stats.hitRate.toFixed(2)}%`)
  console.log(`å‘½ä¸­æ¬¡æ•°: ${stats.hits}`)
  console.log(`æœªå‘½ä¸­æ¬¡æ•°: ${stats.misses}`)
  console.log(`æ·˜æ±°æ¬¡æ•°: ${stats.evictions}`)
  console.log(`è¿‡æœŸæ¸…ç†: ${stats.expirations}`)
  
  // æ ¹æ®å‘½ä¸­ç‡è°ƒæ•´ç­–ç•¥
  if (stats.hitRate < 50) {
    console.warn('ç¼“å­˜å‘½ä¸­ç‡ä½ï¼Œè€ƒè™‘å¢åŠ TTLæˆ–ç¼“å­˜å®¹é‡')
  }
}, 60000) // æ¯åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡
```

---

## ğŸ“š å®Œæ•´ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šå®Œæ•´çš„HTTPå®¢æˆ·ç«¯é…ç½®

```typescript
import { createHttpClient, presets } from '@ldesign/http'
import { BloomFilterCache } from '@ldesign/http/utils/cache-bloom-filter'

// åˆ›å»ºé«˜æ€§èƒ½ç¼“å­˜
const responseCache = new BloomFilterCache<ResponseData>(2000)

// åˆ›å»ºä¼˜åŒ–çš„HTTPå®¢æˆ·ç«¯
const client = await createHttpClient({
  // ä½¿ç”¨RESTé¢„è®¾ä½œä¸ºåŸºç¡€
  ...presets.restful,
  
  // è‡ªå®šä¹‰é…ç½®
  baseURL: 'https://api.example.com',
  timeout: 15000,
  
  // ä½¿ç”¨ä¼˜åŒ–çš„ç¼“å­˜
  cache: {
    enabled: true,
    ttl: 5 * 60 * 1000,
    storage: {
      get: (key) => responseCache.get(key),
      set: (key, value, opts) => {
        responseCache.set(key, value, opts?.ttl || 300000)
      },
      delete: (key) => responseCache.delete(key),
      clear: () => responseCache.clear()
    }
  },
  
  // å…¶ä»–é…ç½®...
})

// ä½¿ç”¨å®¢æˆ·ç«¯
const users = await client.get<User[]>('/users')

// å®šæœŸæŠ¥å‘Šæ€§èƒ½
setInterval(() => {
  const cacheStats = responseCache.getStats()
  const clientStats = client.getPerformanceStats()
  
  console.log('ç¼“å­˜å‘½ä¸­ç‡:', cacheStats.hitRate.toFixed(2), '%')
  console.log('å¹³å‡å“åº”æ—¶é—´:', clientStats.averageResponseTime, 'ms')
}, 60000)
```

### ç¤ºä¾‹2ï¼šè‡ªå®šä¹‰éªŒè¯å™¨ï¼ˆä½¿ç”¨æ­£åˆ™ç¼“å­˜ï¼‰

```typescript
import { REGEX_CACHE, RegexUtils } from '@ldesign/http/utils/regex-cache'

class RequestValidator {
  /**
   * éªŒè¯URLæ ¼å¼
   */
  validateURL(url: string): boolean {
    // ä½¿ç”¨ç¼“å­˜çš„æ­£åˆ™
    return REGEX_CACHE.URL.test(url)
  }
  
  /**
   * éªŒè¯é‚®ç®±æ ¼å¼
   */
  validateEmail(email: string): boolean {
    return RegexUtils.isEmail(email)
  }
  
  /**
   * éªŒè¯ä¸Šä¼ æ–‡ä»¶ç±»å‹
   */
  validateFileType(filename: string, allowedTypes: string[]): boolean {
    const isImage = RegexUtils.isImageFile(filename)
    const isDocument = RegexUtils.isDocumentFile(filename)
    const isVideo = RegexUtils.isVideoFile(filename)
    
    if (allowedTypes.includes('image') && isImage) return true
    if (allowedTypes.includes('document') && isDocument) return true
    if (allowedTypes.includes('video') && isVideo) return true
    
    return false
  }
}
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. ç¼“å­˜å®¹é‡è®¾ç½®

```typescript
// âœ… æ¨èï¼šæ ¹æ®å®é™…éœ€æ±‚è®¾ç½®
const cache = new OptimizedLRUCache(1000) // 1000é¡¹é€šå¸¸è¶³å¤Ÿ

// âŒ ä¸æ¨èï¼šè¿‡å¤§çš„å®¹é‡
const cache = new OptimizedLRUCache(100000) // å¯èƒ½å ç”¨è¿‡å¤šå†…å­˜

// âŒ ä¸æ¨èï¼šè¿‡å°çš„å®¹é‡
const cache = new OptimizedLRUCache(10) // ç¼“å­˜å‘½ä¸­ç‡ä¼šå¾ˆä½
```

### 2. TTLè®¾ç½®

```typescript
// âœ… æ¨èï¼šæ ¹æ®æ•°æ®ç‰¹ç‚¹è®¾ç½®åˆé€‚çš„TTL
cache.set('static-data', data, 60 * 60 * 1000) // 1å°æ—¶ï¼ˆé™æ€æ•°æ®ï¼‰
cache.set('user-data', data, 5 * 60 * 1000) // 5åˆ†é’Ÿï¼ˆç”¨æˆ·æ•°æ®ï¼‰
cache.set('realtime-data', data, 30 * 1000) // 30ç§’ï¼ˆå®æ—¶æ•°æ®ï¼‰

// âŒ ä¸æ¨èï¼šæ‰€æœ‰æ•°æ®ä½¿ç”¨ç›¸åŒTTL
cache.set('key1', data1, 300000)
cache.set('key2', data2, 300000)
```

### 3. å¸ƒéš†è¿‡æ»¤å™¨çš„è¯¯åˆ¤

```typescript
// å¸ƒéš†è¿‡æ»¤å™¨å¯èƒ½æœ‰å‡é˜³æ€§ï¼ˆè¯´å­˜åœ¨ä½†å®é™…ä¸å­˜åœ¨ï¼‰
// ä½†ç»ä¸ä¼šæœ‰å‡é˜´æ€§ï¼ˆè¯´ä¸å­˜åœ¨ä½†å®é™…å­˜åœ¨ï¼‰

const cache = new BloomFilterCache(1000)
cache.set('key1', data1, 300000)

// æŸ¥è¯¢ä¸å­˜åœ¨çš„é”®
const result = cache.get('key999')
// å¯èƒ½çš„æƒ…å†µï¼š
// 1. å¸ƒéš†è¿‡æ»¤å™¨è¯´"ä¸€å®šä¸å­˜åœ¨" â†’ ç«‹å³è¿”å›nullï¼ˆæœ€å¸¸è§ï¼‰
// 2. å¸ƒéš†è¿‡æ»¤å™¨è¯´"å¯èƒ½å­˜åœ¨" â†’ æŸ¥è¯¢Map â†’ è¿”å›nullï¼ˆå¶å°”ï¼Œ<1%ï¼‰
```

---

## ğŸš€ è¿ç§»æŒ‡å—

### ä»æ—§ç¼“å­˜è¿ç§»åˆ°ä¼˜åŒ–ç‰ˆ

```typescript
// æ—§ä»£ç 
import { CacheManager } from '@ldesign/http'
const cache = new CacheManager()

// æ–°ä»£ç ï¼ˆæ¨èï¼‰
import { OptimizedLRUCache } from '@ldesign/http/utils/cache-lru-optimized'
const cache = new OptimizedLRUCache(1000)

// APIå®Œå…¨å…¼å®¹ï¼Œæ— éœ€ä¿®æ”¹ä½¿ç”¨ä»£ç 
cache.set('key', value, ttl)
const data = cache.get('key')
```

### å‡çº§åˆ°å¸ƒéš†è¿‡æ»¤å™¨ç¼“å­˜

```typescript
// å¦‚æœä½ çš„åœºæ™¯ç¬¦åˆä»¥ä¸‹æ¡ä»¶ï¼Œå»ºè®®å‡çº§ï¼š
// 1. ç¼“å­˜é¡¹>1000
// 2. æŸ¥è¯¢ä¸å­˜åœ¨é”®é¢‘ç¹ï¼ˆå¦‚APIé˜²åˆ·ï¼‰
// 3. å¯¹æŸ¥è¯¢æ€§èƒ½è¦æ±‚é«˜

// åªéœ€ä¿®æ”¹å¯¼å…¥å’Œå®ä¾‹åŒ–
import { BloomFilterCache } from '@ldesign/http/utils/cache-bloom-filter'
const cache = new BloomFilterCache(1000)

// å…¶ä»–ä»£ç æ— éœ€ä¿®æ”¹
```

---

## ğŸ“ˆ é¢„æœŸæ”¶ç›Š

### ä½¿ç”¨ä¼˜åŒ–ç¼“å­˜çš„æ”¶ç›Š

**å¯¹äºå¤§å¤šæ•°åº”ç”¨ï¼š**
- ç¼“å­˜æ·˜æ±°æ€§èƒ½ï¼šæå‡500å€
- å†…å­˜å ç”¨ï¼šå‡å°‘50%
- å¹¶å‘æ€§èƒ½ï¼šæå‡60%

**å¯¹äºæŸ¥è¯¢é¢‘ç¹çš„åº”ç”¨ï¼š**
- é¢å¤–åŠ æˆï¼šä¸å­˜åœ¨é”®æŸ¥è¯¢æå‡90%ï¼ˆå¸ƒéš†ï¼‰
- æ€»ä½“æŸ¥è¯¢ï¼šæå‡40-50%

### ä½¿ç”¨æ­£åˆ™ç¼“å­˜çš„æ”¶ç›Š

**å¯¹äºURLå¯†é›†å¤„ç†çš„åº”ç”¨ï¼š**
- URLéªŒè¯ï¼šæå‡33%
- URLåˆå¹¶ï¼šæå‡23%
- æ–‡ä»¶ç±»å‹æ£€æŸ¥ï¼šæå‡29%

**æ€»ä½“æ€§èƒ½ï¼š**
- æ­£åˆ™ç›¸å…³æ“ä½œï¼šæå‡10-30%
- GCå‹åŠ›ï¼šæ˜¾è‘—é™ä½
- å†…å­˜å ç”¨ï¼šä»…2KBé¢å¤–å¼€é”€

---

## ğŸ“ å­¦ä¹ èµ„æº

### ç›¸å…³æ–‡æ¡£

- [HTTPåŒ…å…¨é¢åˆ†ææ€»ç»“.md](./HTTPåŒ…å…¨é¢åˆ†ææ€»ç»“.md) - æ·±åº¦åˆ†æ
- [ä¼˜åŒ–å»ºè®®å’Œæœ€ä½³å®è·µ.md](./ä¼˜åŒ–å»ºè®®å’Œæœ€ä½³å®è·µ.md) - å®è·µæŒ‡å—
- [HTTPåŒ…ä¼˜åŒ–æ€»ç»“æŠ¥å‘Š.md](./HTTPåŒ…ä¼˜åŒ–æ€»ç»“æŠ¥å‘Š.md) - æˆæœæŠ¥å‘Š

### æŠ€æœ¯æ–‡ç« 

- LRUç¼“å­˜ç®—æ³•ï¼š[LeetCode 146](https://leetcode.com/problems/lru-cache/)
- å¸ƒéš†è¿‡æ»¤å™¨ï¼š[Bloom Filters](https://en.wikipedia.org/wiki/Bloom_filter)
- æ­£åˆ™æ€§èƒ½ï¼š[Regular Expression Performance](https://v8.dev/blog/regexp)

---

## ğŸ“ åé¦ˆå’Œæ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿ï¼š
- æŸ¥é˜…ç›¸å…³æ–‡æ¡£
- æäº¤Issue
- å‚ä¸è®¨è®º

---

**æ„Ÿè°¢ä½¿ç”¨ï¼ç¥é¡¹ç›®å¼€å‘é¡ºåˆ©ï¼** ğŸš€

---

**æ–‡æ¡£ç‰ˆæœ¬ï¼š** v1.0  
**æœ€åæ›´æ–°ï¼š** 2025å¹´1æœˆ  
**ç»´æŠ¤è€…ï¼š** @ldesignå›¢é˜Ÿ


