{"version":3,"file":"cancel-manager-enhanced.js","sources":["../../src/utils/cancel-manager-enhanced.ts"],"sourcesContent":["/**\r\n * 增强取消管理器模块\r\n * \r\n * 提供高级请求取消管理功能\r\n */\r\n\r\nimport type { RequestConfig } from '../types'\r\nimport type { CancelToken, CancelTokenImpl  } from './cancel-token'\r\n\r\n\r\n/**\r\n * 请求元数据\r\n */\r\nexport interface RequestMetadata {\r\n  /** 创建时间 */\r\n  createdAt: number\r\n  /** 标签集合 */\r\n  tags: Set<string>\r\n  /** 请求配置 */\r\n  config?: RequestConfig\r\n  /** 关联的控制器 */\r\n  controller: AbortController\r\n  /** 关联的令牌 */\r\n  token?: CancelToken\r\n}\r\n\r\n/**\r\n * 取消策略\r\n */\r\nexport interface CancelStrategy {\r\n  /** 策略名称 */\r\n  name: string\r\n  /** 评估是否应该取消 */\r\n  shouldCancel: (metadata: RequestMetadata, requestId: string) => boolean\r\n  /** 获取取消原因 */\r\n  getReason?: (metadata: RequestMetadata) => string\r\n}\r\n\r\n/**\r\n * 增强取消管理器\r\n */\r\nexport class EnhancedCancelManager {\r\n  private metadata = new Map<string, RequestMetadata>()\r\n  private strategies = new Map<string, CancelStrategy>()\r\n  \r\n  // 内置策略\r\n  private readonly builtInStrategies: Record<string, CancelStrategy> = {\r\n    timeout: {\r\n      name: 'timeout',\r\n      shouldCancel: (metadata: RequestMetadata) => {\r\n        const maxAge = 60000 // 60秒超时\r\n        return Date.now() - metadata.createdAt > maxAge\r\n      },\r\n      getReason: (metadata: RequestMetadata) => {\r\n        const age = Date.now() - metadata.createdAt\r\n        return `Request timeout: ${age}ms`\r\n      },\r\n    },\r\n    duplicate: {\r\n      name: 'duplicate',\r\n      shouldCancel: (metadata: RequestMetadata, _requestId: string) => {\r\n        // 检查是否有相同URL的新请求\r\n        let hasDuplicate = false\r\n        this.metadata.forEach((meta, _id) => {\r\n          if (meta !== metadata && \r\n              meta.config?.url === metadata.config?.url &&\r\n              meta.createdAt > metadata.createdAt) {\r\n            hasDuplicate = true\r\n          }\r\n        })\r\n        return hasDuplicate\r\n      },\r\n      getReason: () => 'Cancelled due to duplicate request',\r\n    },\r\n  }\r\n\r\n  constructor() {\r\n    // 注册内置策略\r\n    Object.values(this.builtInStrategies).forEach(strategy => {\r\n      this.addStrategy(strategy)\r\n    })\r\n  }\r\n\r\n  /**\r\n   * 注册请求\r\n   */\r\n  register(\r\n    requestId: string,\r\n    controller: AbortController,\r\n    options?: {\r\n      token?: CancelToken\r\n      tags?: string[]\r\n      config?: RequestConfig\r\n    },\r\n  ): void {\r\n    const metadata: RequestMetadata = {\r\n      createdAt: Date.now(),\r\n      tags: new Set(options?.tags || []),\r\n      config: options?.config,\r\n      controller,\r\n      token: options?.token,\r\n    }\r\n\r\n    this.metadata.set(requestId, metadata)\r\n\r\n    // 如果有令牌，监听取消\r\n    if (options?.token) {\r\n      options.token.promise\r\n        .then(() => {\r\n          this.cancel(requestId)\r\n        })\r\n        .catch(() => {\r\n          // 忽略错误\r\n        })\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 取消请求\r\n   */\r\n  cancel(requestId: string, reason = 'Request cancelled'): boolean {\r\n    const metadata = this.metadata.get(requestId)\r\n    if (!metadata) {\r\n      return false\r\n    }\r\n\r\n    metadata.controller.abort(reason)\r\n    \r\n    if (metadata.token && !metadata.token.isCancelled) {\r\n      (metadata.token as CancelTokenImpl).cancel(reason)\r\n    }\r\n\r\n    this.metadata.delete(requestId)\r\n    return true\r\n  }\r\n\r\n  /**\r\n   * 批量取消\r\n   */\r\n  cancelBatch(requestIds: string[], reason?: string): number {\r\n    let cancelledCount = 0\r\n    \r\n    requestIds.forEach(id => {\r\n      if (this.cancel(id, reason)) {\r\n        cancelledCount++\r\n      }\r\n    })\r\n\r\n    return cancelledCount\r\n  }\r\n\r\n  /**\r\n   * 按标签取消\r\n   */\r\n  cancelByTags(tags: string[], reason?: string): number {\r\n    const idsToCancel = new Set<string>()\r\n\r\n    tags.forEach(tag => {\r\n      this.getRequestIdsByTag(tag).forEach(id => idsToCancel.add(id))\r\n    })\r\n\r\n    return this.cancelBatch(Array.from(idsToCancel), reason)\r\n  }\r\n\r\n  /**\r\n   * 按策略取消\r\n   */\r\n  cancelByStrategy(strategyName: string, reason?: string): number {\r\n    const strategy = this.strategies.get(strategyName)\r\n    if (!strategy) {\r\n      return 0\r\n    }\r\n\r\n    const idsToCancel: string[] = []\r\n\r\n    this.metadata.forEach((meta, id) => {\r\n      if (strategy.shouldCancel(meta, id)) {\r\n        idsToCancel.push(id)\r\n      }\r\n    })\r\n\r\n    const finalReason = reason || \r\n      (strategy.getReason ? \r\n        idsToCancel.map(id => strategy.getReason!(this.metadata.get(id)!))[0] : \r\n        `Cancelled by strategy: ${strategyName}`)\r\n\r\n    return this.cancelBatch(idsToCancel, finalReason)\r\n  }\r\n\r\n  /**\r\n   * 取消超时请求\r\n   */\r\n  cancelTimeout(timeout: number, reason?: string): number {\r\n    const now = Date.now()\r\n    const idsToCancel: string[] = []\r\n\r\n    this.metadata.forEach((meta, requestId) => {\r\n      if (now - meta.createdAt > timeout) {\r\n        idsToCancel.push(requestId)\r\n      }\r\n    })\r\n\r\n    return this.cancelBatch(\r\n      idsToCancel,\r\n      reason || `Timeout exceeded: ${timeout}ms`,\r\n    )\r\n  }\r\n\r\n  /**\r\n   * 条件取消\r\n   */\r\n  cancelWhere(\r\n    predicate: (metadata: RequestMetadata, requestId: string) => boolean,\r\n    reason?: string,\r\n  ): number {\r\n    const idsToCancel: string[] = []\r\n\r\n    this.metadata.forEach((meta, requestId) => {\r\n      if (predicate(meta, requestId)) {\r\n        idsToCancel.push(requestId)\r\n      }\r\n    })\r\n\r\n    return this.cancelBatch(idsToCancel, reason)\r\n  }\r\n\r\n  /**\r\n   * 取消所有请求\r\n   */\r\n  cancelAll(reason = 'All requests cancelled'): number {\r\n    const count = this.metadata.size\r\n\r\n    this.metadata.forEach((_meta, id) => {\r\n      this.cancel(id, reason)\r\n    })\r\n\r\n    return count\r\n  }\r\n\r\n  /**\r\n   * 清理已完成的请求\r\n   */\r\n  cleanup(requestId: string): void {\r\n    this.metadata.delete(requestId)\r\n  }\r\n\r\n  /**\r\n   * 自动清理老旧请求\r\n   */\r\n  autoCleanup(maxAge = 5 * 60 * 1000): number {\r\n    const now = Date.now()\r\n    const idsToRemove: string[] = []\r\n\r\n    this.metadata.forEach((meta, id) => {\r\n      if (now - meta.createdAt > maxAge) {\r\n        idsToRemove.push(id)\r\n      }\r\n    })\r\n\r\n    idsToRemove.forEach(id => {\r\n      this.metadata.delete(id)\r\n    })\r\n\r\n    return idsToRemove.length\r\n  }\r\n\r\n  /**\r\n   * 添加策略\r\n   */\r\n  addStrategy(strategy: CancelStrategy): void {\r\n    this.strategies.set(strategy.name, strategy)\r\n  }\r\n\r\n  /**\r\n   * 移除策略\r\n   */\r\n  removeStrategy(name: string): boolean {\r\n    return this.strategies.delete(name)\r\n  }\r\n\r\n  /**\r\n   * 获取策略\r\n   */\r\n  getStrategy(name: string): CancelStrategy | undefined {\r\n    return this.strategies.get(name)\r\n  }\r\n\r\n  /**\r\n   * 获取所有策略名称\r\n   */\r\n  getStrategyNames(): string[] {\r\n    return Array.from(this.strategies.keys())\r\n  }\r\n\r\n  /**\r\n   * 应用所有策略\r\n   */\r\n  applyStrategies(): number {\r\n    let totalCancelled = 0\r\n\r\n    this.strategies.forEach((_strategy, name) => {\r\n      totalCancelled += this.cancelByStrategy(name)\r\n    })\r\n\r\n    return totalCancelled\r\n  }\r\n\r\n  /**\r\n   * 获取指定标签的所有请求ID\r\n   */\r\n  getRequestIdsByTag(tag: string): string[] {\r\n    const ids: string[] = []\r\n\r\n    this.metadata.forEach((meta, requestId) => {\r\n      if (meta.tags.has(tag)) {\r\n        ids.push(requestId)\r\n      }\r\n    })\r\n\r\n    return ids\r\n  }\r\n\r\n  /**\r\n   * 获取请求数量统计\r\n   */\r\n  getRequestCountByTag(): Map<string, number> {\r\n    const counts = new Map<string, number>()\r\n\r\n    this.metadata.forEach((meta) => {\r\n      meta.tags.forEach((tag) => {\r\n        counts.set(tag, (counts.get(tag) || 0) + 1)\r\n      })\r\n    })\r\n\r\n    return counts\r\n  }\r\n\r\n  /**\r\n   * 获取活跃请求\r\n   */\r\n  getActiveRequests(): Array<{\r\n    id: string\r\n    tags: string[]\r\n    age: number\r\n    url?: string\r\n  }> {\r\n    const now = Date.now()\r\n    const requests: Array<{\r\n      id: string\r\n      tags: string[]\r\n      age: number\r\n      url?: string\r\n    }> = []\r\n\r\n    this.metadata.forEach((meta, id) => {\r\n      requests.push({\r\n        id,\r\n        tags: Array.from(meta.tags),\r\n        age: now - meta.createdAt,\r\n        url: meta.config?.url,\r\n      })\r\n    })\r\n\r\n    return requests\r\n  }\r\n\r\n  /**\r\n   * 获取统计信息\r\n   */\r\n  getStats() {\r\n    const now = Date.now()\r\n    let totalAge = 0\r\n    let oldestAge = 0\r\n    const tagCounts = this.getRequestCountByTag()\r\n\r\n    this.metadata.forEach((meta) => {\r\n      const age = now - meta.createdAt\r\n      totalAge += age\r\n      oldestAge = Math.max(oldestAge, age)\r\n    })\r\n\r\n    return {\r\n      active: this.metadata.size,\r\n      byTag: Object.fromEntries(tagCounts),\r\n      averageAge: this.metadata.size > 0 ? totalAge / this.metadata.size : 0,\r\n      oldestAge,\r\n      strategies: this.getStrategyNames(),\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 为请求添加标签\r\n   */\r\n  addTags(requestId: string, ...tags: string[]): boolean {\r\n    const meta = this.metadata.get(requestId)\r\n    if (!meta) {\r\n      return false\r\n    }\r\n\r\n    tags.forEach(tag => meta.tags.add(tag))\r\n    return true\r\n  }\r\n\r\n  /**\r\n   * 移除请求标签\r\n   */\r\n  removeTags(requestId: string, ...tags: string[]): boolean {\r\n    const meta = this.metadata.get(requestId)\r\n    if (!meta) {\r\n      return false\r\n    }\r\n\r\n    tags.forEach(tag => meta.tags.delete(tag))\r\n    return true\r\n  }\r\n\r\n  /**\r\n   * 获取请求标签\r\n   */\r\n  getTags(requestId: string): string[] {\r\n    const meta = this.metadata.get(requestId)\r\n    return meta ? Array.from(meta.tags) : []\r\n  }\r\n\r\n  /**\r\n   * 检查请求是否存在\r\n   */\r\n  has(requestId: string): boolean {\r\n    return this.metadata.has(requestId)\r\n  }\r\n\r\n  /**\r\n   * 获取请求元数据\r\n   */\r\n  getMetadata(requestId: string): RequestMetadata | undefined {\r\n    return this.metadata.get(requestId)\r\n  }\r\n\r\n  /**\r\n   * 获取活跃请求数量\r\n   */\r\n  getActiveRequestCount(): number {\r\n    return this.metadata.size\r\n  }\r\n\r\n  /**\r\n   * 创建合并的 AbortSignal\r\n   */\r\n  static createMergedSignal(signals: (AbortSignal | undefined)[]): AbortSignal {\r\n    const validSignals = signals.filter(\r\n      (signal): signal is AbortSignal => signal !== undefined,\r\n    )\r\n\r\n    if (validSignals.length === 0) {\r\n      return new AbortController().signal\r\n    }\r\n\r\n    if (validSignals.length === 1) {\r\n      return validSignals[0]!\r\n    }\r\n\r\n    // 创建一个新的控制器来合并多个信号\r\n    const controller = new AbortController()\r\n\r\n    const abortHandler = () => {\r\n      controller.abort()\r\n    }\r\n\r\n    validSignals.forEach((signal) => {\r\n      if (signal.aborted) {\r\n        controller.abort()\r\n        return\r\n      }\r\n      signal.addEventListener('abort', abortHandler, { once: true })\r\n    })\r\n\r\n    return controller.signal\r\n  }\r\n}\r\n\r\n/**\r\n * 创建增强取消管理器\r\n */\r\nexport function createEnhancedCancelManager(): EnhancedCancelManager {\r\n  return new EnhancedCancelManager()\r\n}"],"names":["EnhancedCancelManager","constructor","this","metadata","Map","strategies","builtInStrategies","timeout","name","shouldCancel","Date","now","createdAt","getReason","duplicate","_requestId","hasDuplicate","forEach","meta","_id","config","url","Object","values","strategy","addStrategy","register","requestId","controller","options","tags","Set","token","set","promise","then","cancel","catch","reason","get","abort","isCancelled","delete","cancelBatch","requestIds","cancelledCount","id","cancelByTags","idsToCancel","tag","getRequestIdsByTag","add","Array","from","cancelByStrategy","strategyName","push","finalReason","map","cancelTimeout","cancelWhere","predicate","cancelAll","count","size","_meta","cleanup","autoCleanup","maxAge","idsToRemove","length","removeStrategy","getStrategy","getStrategyNames","keys","applyStrategies","totalCancelled","_strategy","ids","has","getRequestCountByTag","counts","getActiveRequests","requests","age","getStats","totalAge","oldestAge","tagCounts","Math","max","active","byTag","fromEntries","averageAge","addTags","removeTags","getTags","getMetadata","getActiveRequestCount","createMergedSignal","signals","validSignals","filter","signal","AbortController","abortHandler","aborted","addEventListener","once","createEnhancedCancelManager","o","i"],"mappings":"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"}