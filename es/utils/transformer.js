class t{constructor(r={}){this.config={transformDates:r.transformDates??!0,transformBigInt:r.transformBigInt??!1,nullToUndefined:r.nullToUndefined??!1,emptyStringToNull:r.emptyStringToNull??!1,datePattern:r.datePattern??t.ISO_DATE_REGEX,customTransformers:r.customTransformers??[]}}transform(t){return this.transformValue("root",t)}transformValue(t,r){for(const n of this.config?.customTransformers||[]){const e=n(t,r);if(void 0!==e)return e}return null===r?this.config?.nullToUndefined?void 0:null:void 0!==r?"string"==typeof r?this.transformString(t,r):Array.isArray(r)?r.map((r,n)=>this.transformValue(`${t}[${n}]`,r)):"object"==typeof r&&null!==r?this.transformObject(r):r:void 0}transformString(t,r){if(""===r&&this.config?.emptyStringToNull)return null;if(this.config?.transformDates&&this.isDateField(t,r)){const t=new Date(r);if(!Number.isNaN(t.getTime()))return t}if(this.config?.transformBigInt&&this.isBigIntString(r))try{return BigInt(r)}catch{}return r}transformObject(t){const r={};for(const[n,e]of Object.entries(t))r[n]=this.transformValue(n,e);return r}isDateField(r,n){const e=r.toLowerCase(),s=t.DATE_FIELD_NAMES.some(t=>e.includes(t.toLowerCase())),a=this.config?.datePattern.test(n);return s||a}isBigIntString(t){if(!/^\d+$/.test(t))return!1;const r=Number(t);return r>Number.MAX_SAFE_INTEGER||r<Number.MIN_SAFE_INTEGER}serialize(t){return this.serializeValue(t)}serializeValue(t){if(t instanceof Date)return t.toISOString();if("bigint"==typeof t)return t.toString();if(Array.isArray(t))return t.map(t=>this.serializeValue(t));if("object"==typeof t&&null!==t){const r={};for(const[n,e]of Object.entries(t))r[n]=this.serializeValue(e);return r}return t}}function r(r){return new t(r)}t.ISO_DATE_REGEX=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d{3})?Z?$/,t.DATE_FIELD_NAMES=["date","time","createdAt","updatedAt","deletedAt","publishedAt","timestamp","startTime","endTime"];const n=new t;function e(r){const n=new t(r);return{request:{onFulfilled:t=>(t.data&&(t.data=n.serialize(t.data)),t)},response:{onFulfilled:t=>(t.data&&(t.data=n.transform(t.data)),t)}}}function s(r){return new t({transformDates:!0,transformBigInt:!1}).transform(r)}function a(r){return new t({transformDates:!1,transformBigInt:!0}).transform(r)}function i(r){return new t({transformDates:!1,nullToUndefined:!0}).transform(r)}export{t as DataTransformer,e as createDataTransformInterceptor,r as createDataTransformer,n as globalDataTransformer,i as nullToUndefined,a as transformBigInts,s as transformDates};
//# sourceMappingURL=transformer.js.map
