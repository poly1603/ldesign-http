{"version":3,"file":"logger.js","sources":["../../src/utils/logger.ts"],"sourcesContent":["/**\n * 统一日志管理器\n *\n * 替换所有console.log,提供更好的日志控制\n */\n\n// 浏览器兼容的 process.env 访问\nconst isBrowser = typeof window !== 'undefined'\nconst env = isBrowser ? (import.meta.env || {}) : (globalThis.process?.env || {})\n\nexport enum LogLevel {\n  DEBUG = 0,\n  INFO = 1,\n  WARN = 2,\n  ERROR = 3,\n  NONE = 4,\n}\n\nexport interface LoggerConfig {\n  /** 日志级别 */\n  level?: LogLevel\n  /** 是否在生产环境启用 */\n  enableInProduction?: boolean\n  /** 自定义日志处理器 */\n  customHandler?: (level: LogLevel, message: string, data?: any) => void\n  /** 是否显示时间戳 */\n  showTimestamp?: boolean\n  /** 日志前缀 */\n  prefix?: string\n}\n\n/**\n * 日志管理器\n *\n * @example\n * ```typescript\n * // 配置日志级别\n * logger.setLevel(LogLevel.WARN) // 只显示警告和错误\n *\n * // 使用日志\n * logger.debug('调试信息', { data: 123 })\n * logger.info('请求已发送')\n * logger.warn('请求耗时较长')\n * logger.error('请求失败', error)\n *\n * // 分组日志\n * logger.group('请求详情')\n * logger.info('URL:', url)\n * logger.info('Method:', method)\n * logger.groupEnd()\n * ```\n */\n\nexport class Logger {\n  private config: Omit<Required<LoggerConfig>, 'customHandler'> & { customHandler: ((level: LogLevel, message: string, data?: any) => void) | null }\n  private isProduction: boolean\n\n  constructor(config: LoggerConfig = {}) {\n    this.isProduction = env.NODE_ENV === 'production' || env.MODE === 'production'\n\n    this.config = {\n      level: config.level ?? (this.isProduction ? LogLevel.WARN : LogLevel.DEBUG),\n      enableInProduction: config.enableInProduction ?? false,\n      customHandler: config.customHandler ?? null,\n      showTimestamp: config.showTimestamp ?? true,\n      prefix: config.prefix ?? '[HTTP]',\n    }\n  }\n\n  /**\n   * 设置日志级别\n   */\n  setLevel(level: LogLevel): void {\n    if (this.config) {\n      this.config.level = level\n    }\n  }\n\n  /**\n   * 获取当前日志级别\n   */\n  getLevel(): LogLevel {\n    return this.config?.level\n  }\n\n  /**\n   * 调试日志\n   */\n  debug(message: string, ...args: any[]): void {\n    this.log(LogLevel.DEBUG, message, ...args)\n  }\n\n  /**\n   * 信息日志\n   */\n  info(message: string, ...args: any[]): void {\n    this.log(LogLevel.INFO, message, ...args)\n  }\n\n  /**\n   * 警告日志\n   */\n  warn(message: string, ...args: any[]): void {\n    this.log(LogLevel.WARN, message, ...args)\n  }\n\n  /**\n   * 错误日志\n   */\n  error(message: string, ...args: any[]): void {\n    this.log(LogLevel.ERROR, message, ...args)\n  }\n\n  /**\n   * 分组开始\n   */\n  group(label: string): void {\n    if (this.shouldLog(LogLevel.DEBUG)) {\n      console.group(this.formatMessage(label))\n    }\n  }\n\n  /**\n   * 折叠分组开始\n   */\n  groupCollapsed(label: string): void {\n    if (this.shouldLog(LogLevel.DEBUG)) {\n      console.groupCollapsed(this.formatMessage(label))\n    }\n  }\n\n  /**\n   * 分组结束\n   */\n  groupEnd(): void {\n    if (this.shouldLog(LogLevel.DEBUG)) {\n      console.groupEnd()\n    }\n  }\n\n  /**\n   * 表格输出\n   */\n  table(data: any): void {\n    if (this.shouldLog(LogLevel.DEBUG)) {\n      console.table(data)\n    }\n  }\n\n  /**\n   * 计时开始\n   */\n  time(label: string): void {\n    if (this.shouldLog(LogLevel.DEBUG)) {\n      console.time(this.formatMessage(label))\n    }\n  }\n\n  /**\n   * 计时结束\n   */\n  timeEnd(label: string): void {\n    if (this.shouldLog(LogLevel.DEBUG)) {\n      console.timeEnd(this.formatMessage(label))\n    }\n  }\n\n  /**\n   * 核心日志方法\n   */\n  private log(level: LogLevel, message: string, ...args: any[]): void {\n    if (!this.shouldLog(level)) {\n      return\n    }\n\n    const formattedMessage = this.formatMessage(message)\n\n    // 使用自定义处理器\n    if (this.config?.customHandler) {\n      this.config?.customHandler(level, message, args.length > 0 ? args : undefined)\n      return\n    }\n\n    // 根据级别选择console方法\n    switch (level) {\n      case LogLevel.DEBUG:\n        console.debug(formattedMessage, ...args)\n        break\n      case LogLevel.INFO:\n        console.info(formattedMessage, ...args)\n        break\n      case LogLevel.WARN:\n        console.warn(formattedMessage, ...args)\n        break\n      case LogLevel.ERROR:\n        console.error(formattedMessage, ...args)\n        break\n    }\n  }\n\n  /**\n   * 判断是否应该输出日志\n   */\n  private shouldLog(level: LogLevel): boolean {\n    // 生产环境检查\n    if (this.isProduction && !this.config?.enableInProduction) {\n      return false\n    }\n\n    // 级别检查\n    return level >= this.config?.level\n  }\n\n  /**\n   * 格式化消息\n   */\n  private formatMessage(message: string): string {\n    const parts: string[] = []\n\n    // 添加前缀\n    if (this.config?.prefix) {\n      parts.push(this.config?.prefix)\n    }\n\n    // 添加时间戳\n    if (this.config?.showTimestamp) {\n      const timestamp = new Date().toISOString().split('T')[1].slice(0, -1)\n      parts.push(`[${timestamp}]`)\n    }\n\n    parts.push(message)\n\n    return parts.join(' ')\n  }\n\n  /**\n   * 创建子日志器\n   */\n  createChild(prefix: string): Logger {\n    const { customHandler, ...restConfig } = this.config\n    return new Logger({\n      ...restConfig,\n      customHandler: customHandler || undefined,\n      prefix: `${this.config?.prefix} ${prefix}`,\n    })\n  }\n}\n\n/**\n * 全局日志器实例\n */\nexport const logger = new Logger()\n\n/**\n * 创建日志器\n */\nexport function createLogger(config?: LoggerConfig): Logger {\n  return new Logger(config)\n}\n\n/**\n * 开发环境专用日志器\n */\nexport const devLogger = new Logger({\n  level: LogLevel.DEBUG,\n  enableInProduction: false,\n  prefix: '[HTTP:DEV]',\n})\n"],"names":["env","window","globalThis","process","LogLevel","DEBUG","INFO","WARN","ERROR","NONE","Logger","constructor","config","this","isProduction","NODE_ENV","MODE","level","enableInProduction","customHandler","showTimestamp","prefix","setLevel","getLevel","debug","message","args","log","info","warn","error","group","label","shouldLog","groupCollapsed","groupEnd","table","data","time","timeEnd","formatMessage","length","parts","push","timestamp","Date","toISOString","split","slice","join","createChild","restConfig","logger","createLogger","devLogger","o","n","h","a","g"],"mappings":"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"}