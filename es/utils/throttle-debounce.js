function t(t,n,e={}){const{leading:l=!1,trailing:i=!0,maxWait:u}=e;let c,a=null,o=null,s=null,r=0,h=null,m=null;function f(n){const e=h,l=m;h=null,m=null,r=n;const i=t.apply(l,e);return c=i,i}function x(t){const e=t-(s??0);return null===s||e>=n||e<0||void 0!==u&&t-r>=u}function g(){const t=Date.now();x(t)?d(t):a=setTimeout(g,function(t){const e=t-r,l=n-(t-(s??0));return void 0!==u?Math.min(l,u-e):l}(t))}function d(t){a=null,i&&h?c=f(t):(h=null,m=null)}const p=function t(...e){const i=Date.now(),d=x(i);return h=e,m=t,s=i,d?(null===a&&function(t){r=t,a=setTimeout(g,n),l&&(c=f(t))}(s),void 0!==u&&(null!==o&&clearTimeout(o),o=setTimeout(g,u)),c):(null===a&&(a=setTimeout(g,n)),c)};return p.cancel=function(){null!==a&&clearTimeout(a),null!==o&&clearTimeout(o),r=0,h=null,s=null,m=null,a=null,o=null},p.flush=function(){return null===a||d(Date.now()),c},p.pending=function(){return null!==a},p}function n(n,e,l={}){const{leading:i=!0,trailing:u=!0}=l;return t(n,e,{leading:i,trailing:u,maxWait:e})}function e(t,n={}){const{minDelay:e=100,maxDelay:l=1e3,factor:i=1.5}=n;let u=e,c=0,a=null,o=0;function s(){null!==a&&(clearTimeout(a),a=null)}const r=function(...n){(function(){const t=Date.now();t-c<2*u?(u=Math.min(u*i,l),o++):o>0&&(u=Math.max(u/i,e),o=Math.max(0,o-1)),c=t})(),s(),a=setTimeout(()=>{t.apply(this,n),a=null},u)};return r.cancel=s,r.reset=function(){s(),u=e,c=0,o=0},r}class l{constructor(t,n){this.maxCalls=t,this.timeWindow=n,this.calls=[]}canExecute(){return this.cleanup(),this.calls.length<this.maxCalls}recordExecution(){this.calls.push(Date.now())}execute(t){if(this.canExecute())return this.recordExecution(),t()}getNextAvailableTime(){if(this.cleanup(),this.calls.length<this.maxCalls)return Date.now();const t=this.calls[0];return t?t+this.timeWindow:null}cleanup(){const t=Date.now();this.calls=this.calls.filter(n=>t-n<this.timeWindow)}reset(){this.calls=[]}getCurrentCalls(){return this.cleanup(),this.calls.length}getRemainingCalls(){return this.cleanup(),Math.max(0,this.maxCalls-this.calls.length)}}function i(t,n,e,i={}){const u=new l(n,e),c=[],{onLimit:a,queueOverflow:o="drop"}=i;function s(){for(;c.length>0&&u.canExecute();){const t=c.shift();t&&(u.recordExecution(),t())}if(c.length>0){const t=u.getNextAvailableTime();if(t){const n=Math.max(0,t-Date.now());setTimeout(s,n)}}}const r=function(...e){const l=()=>t.apply(this,e);u.canExecute()?(u.recordExecution(),l()):(a?.(),"replace"===o&&c.length>=n&&c.shift(),("drop"!==o||c.length<n)&&(c.push(l),s()))};return r.limiter=u,r.queue=c,r}export{l as RateLimiter,e as createAdaptiveDebounce,i as createRateLimitedFunction,t as debounce,n as throttle};
//# sourceMappingURL=throttle-debounce.js.map
