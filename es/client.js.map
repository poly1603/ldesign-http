{"version":3,"file":"client.js","sources":["../src/client.ts"],"sourcesContent":["import type {\n  ErrorInterceptor,\n  HttpAdapter,\n  HttpClient,\n  HttpClientConfig,\n  HttpError,\n  InterceptorManager,\n  RequestConfig,\n  RequestInterceptor,\n  ResponseData,\n  ResponseInterceptor,\n  RetryConfig,\n} from './types'\nimport type { CancelManager } from './utils/cancel'\nimport type {\n  DownloadConfig,\n  DownloadResult,\n} from './utils/download'\nimport type { Priority } from './utils/priority'\nimport type {\n  UploadConfig,\n  UploadResult,\n} from './utils/upload'\nimport { InterceptorManagerImpl } from './interceptors/manager'\nimport { generateId } from './utils'\nimport { CacheManager } from './utils/cache'\nimport { globalCancelManager } from './utils/cancel'\nimport { ConcurrencyManager } from './utils/concurrency'\nimport {\n  DownloadProgressCalculator,\n  getFilenameFromResponse,\n  getFilenameFromURL,\n  getMimeTypeFromFilename,\n  saveFileToLocal,\n} from './utils/download'\nimport { RetryManager } from './utils/error'\nimport { RequestMonitor } from './utils/monitor'\nimport { RequestPool } from './utils/pool'\nimport { determinePriority, PriorityQueue } from './utils/priority'\n// 静态导入工具函数，避免动态导入冲突\nimport { createUploadFormData, ProgressCalculator, validateFile } from './utils/upload'\n\n/**\n * HTTP 客户端实现\n *\n * 提供完整的 HTTP 请求功能，包括：\n * - 多适配器支持（Fetch、Axios、Alova）\n * - 智能缓存系统\n * - 自动重试机制\n * - 并发控制和请求去重\n * - 拦截器链\n * - 上传/下载功能\n * - 错误处理和恢复\n * - 性能监控\n *\n * @example\n * ```typescript\n * const client = new HttpClientImpl({\n *   baseURL: 'https://api.example.com',\n *   timeout: 10000,\n *   cache: { enabled: true },\n *   retry: { enabled: true, maxAttempts: 3 }\n * }, adapter)\n *\n * // 发送 GET 请求\n * const response = await client.get<User[]>('/users')\n *\n * // 发送 POST 请求\n * const newUser = await client.post<User>('/users', { name: 'John' })\n * ```\n */\nexport class HttpClientImpl implements HttpClient {\n  private config: HttpClientConfig\n  private adapter: HttpAdapter\n  private retryManager: RetryManager\n  // private timeoutManager: TimeoutManager\n  private cancelManager: CancelManager\n  private cacheManager: CacheManager\n  private concurrencyManager: ConcurrencyManager\n  private monitor: RequestMonitor\n  private priorityQueue: PriorityQueue\n  private requestPool: RequestPool\n  private isDestroyed = false\n\n  public interceptors: {\n    request: InterceptorManager<RequestInterceptor>\n    response: InterceptorManager<ResponseInterceptor>\n    error: InterceptorManager<ErrorInterceptor>\n  }\n\n  constructor(config: HttpClientConfig = {}, adapter?: HttpAdapter) {\n    this.config = {\n      timeout: 10000,\n      headers: {\n        'Content-Type': 'application/json',\n        ...config.headers,\n      },\n      ...config,\n    }\n\n    if (!adapter) {\n      throw new Error('HTTP adapter is required')\n    }\n    this.adapter = adapter\n\n    // 初始化管理器\n    this.retryManager = new RetryManager(config.retry)\n    // this.timeoutManager = new TimeoutManager()\n    this.cancelManager = globalCancelManager\n    this.cacheManager = new CacheManager(config.cache)\n    this.concurrencyManager = new ConcurrencyManager(config.concurrency)\n    this.monitor = new RequestMonitor(config.monitor as any)\n    this.priorityQueue = new PriorityQueue(config.priorityQueue as any)\n    this.requestPool = new RequestPool(config.connectionPool as any)\n\n    // 初始化拦截器\n    this.interceptors = {\n      request: new InterceptorManagerImpl<RequestInterceptor>(),\n      response: new InterceptorManagerImpl<ResponseInterceptor>(),\n      error: new InterceptorManagerImpl<ErrorInterceptor>(),\n    }\n  }\n\n  /**\n   * 发送请求（优化版）\n   */\n  async request<T = unknown>(config: RequestConfig): Promise<ResponseData<T>> {\n    this.checkDestroyed()\n\n    // 合并配置（只在需要时进行深度合并）\n    const mergedConfig = this.optimizedMergeConfig(config)\n\n    // 生成请求ID\n    const requestId = generateId()\n\n    // 开始监控\n    this.monitor.startRequest(requestId, mergedConfig)\n\n    // 判断优先级\n    const priority = determinePriority(mergedConfig)\n\n    // 使用优先级队列执行请求\n    if (priority !== undefined && this.priorityQueue) {\n      return this.priorityQueue.enqueue(\n        mergedConfig,\n        async () => {\n          try {\n            const response = await this.executeRequestWithRetry<T>(mergedConfig, requestId)\n            this.monitor.endRequest(requestId, mergedConfig, response)\n            return response\n          }\n          catch (error) {\n            this.monitor.endRequest(requestId, mergedConfig, undefined, error as Error)\n            throw error\n          }\n        },\n        priority,\n      )\n    }\n\n    // 普通执行\n    try {\n      const response = await this.executeRequestWithRetry<T>(mergedConfig, requestId)\n      this.monitor.endRequest(requestId, mergedConfig, response)\n      return response\n    }\n    catch (error) {\n      this.monitor.endRequest(requestId, mergedConfig, undefined, error as Error)\n      throw error\n    }\n  }\n\n  /**\n   * 执行带重试的请求\n   */\n  private async executeRequestWithRetry<T = unknown>(\n    config: RequestConfig,\n    requestId: string,\n  ): Promise<ResponseData<T>> {\n    // 如果启用了重试，使用重试管理器\n    const retryConfig = config.retry as RetryConfig | undefined\n    if (retryConfig?.retries && retryConfig.retries > 0) {\n      return this.retryManager.executeWithRetry(\n        () => {\n          this.monitor.recordRetry(requestId)\n          return this.executeRequest<T>(config)\n        },\n        config,\n      )\n    }\n\n    return this.executeRequest<T>(config)\n  }\n\n  /**\n   * 执行单次请求\n   */\n  private async executeRequest<T = unknown>(\n    config: RequestConfig,\n  ): Promise<ResponseData<T>> {\n    // 检查缓存\n    const cachedResponse = await this.cacheManager.get<T>(config)\n    if (cachedResponse) {\n      return cachedResponse\n    }\n\n    // 使用并发控制执行请求\n    return this.concurrencyManager.execute(\n      () => this.performRequest<T>(config),\n      config,\n    )\n  }\n\n  /**\n   * 执行实际的请求\n   */\n  private async performRequest<T = unknown>(\n    config: RequestConfig,\n  ): Promise<ResponseData<T>> {\n    let processedConfig: RequestConfig | null = null\n    \n    try {\n      // 执行请求拦截器\n      processedConfig = await this.processRequestInterceptors(config)\n\n      // 发送请求\n      let response = await this.adapter.request<T>(processedConfig)\n\n      // 执行响应拦截器\n      response = await this.processResponseInterceptors(response)\n\n      // 缓存响应\n      await this.cacheManager.set(processedConfig, response)\n\n      return response\n    }\n    catch (error) {\n      // 执行错误拦截器\n      const processedError = await this.processErrorInterceptors(\n        error as HttpError,\n      )\n      throw processedError\n    }\n    // 移除配置回收逻辑，让GC自动处理\n  }\n\n  /**\n   * GET 请求\n   */\n  get<T = unknown>(\n    url: string,\n    config: RequestConfig = {},\n  ): Promise<ResponseData<T>> {\n    return this.request<T>({\n      ...config,\n      method: 'GET',\n      url,\n    })\n  }\n\n  /**\n   * POST 请求\n   */\n  post<T = unknown, D = unknown>(\n    url: string,\n    data?: D,\n    config: RequestConfig = {},\n  ): Promise<ResponseData<T>> {\n    return this.request<T>({\n      ...config,\n      method: 'POST',\n      url,\n      data,\n    })\n  }\n\n  /**\n   * PUT 请求\n   */\n  put<T = unknown, D = unknown>(\n    url: string,\n    data?: D,\n    config: RequestConfig = {},\n  ): Promise<ResponseData<T>> {\n    return this.request<T>({\n      ...config,\n      method: 'PUT',\n      url,\n      data,\n    })\n  }\n\n  /**\n   * DELETE 请求\n   */\n  delete<T = unknown>(\n    url: string,\n    config: RequestConfig = {},\n  ): Promise<ResponseData<T>> {\n    return this.request<T>({\n      ...config,\n      method: 'DELETE',\n      url,\n    })\n  }\n\n  /**\n   * PATCH 请求\n   */\n  patch<T = unknown, D = unknown>(\n    url: string,\n    data?: D,\n    config: RequestConfig = {},\n  ): Promise<ResponseData<T>> {\n    return this.request<T>({\n      ...config,\n      method: 'PATCH',\n      url,\n      data,\n    })\n  }\n\n  /**\n   * HEAD 请求\n   */\n  head<T = unknown>(\n    url: string,\n    config: RequestConfig = {},\n  ): Promise<ResponseData<T>> {\n    return this.request<T>({\n      ...config,\n      method: 'HEAD',\n      url,\n    })\n  }\n\n  /**\n   * OPTIONS 请求\n   */\n  options<T = unknown>(\n    url: string,\n    config: RequestConfig = {},\n  ): Promise<ResponseData<T>> {\n    return this.request<T>({\n      ...config,\n      method: 'OPTIONS',\n      url,\n    })\n  }\n\n  /**\n   * 取消所有请求\n   */\n  cancelAll(reason?: string): void {\n    this.cancelManager.cancelAll(reason)\n  }\n\n  /**\n   * 获取活跃请求数量\n   */\n  getActiveRequestCount(): number {\n    return this.cancelManager.getActiveRequestCount()\n  }\n\n  /**\n   * 更新重试配置\n   */\n  updateRetryConfig(config: Partial<RetryConfig>): void {\n    this.retryManager.updateConfig(config)\n  }\n\n  /**\n   * 设置配置\n   */\n  setConfig(config: Partial<HttpClientConfig>): void {\n    this.config = {\n      ...this.config,\n      ...config,\n      headers: {\n        ...this.config?.headers,\n        ...config.headers,\n      },\n    }\n  }\n\n  /**\n   * 获取当前配置\n   */\n  getConfig(): HttpClientConfig {\n    return { ...this.config }\n  }\n\n  /**\n   * 添加请求拦截器\n   */\n  addRequestInterceptor(\n    fulfilled: (config: RequestConfig) => RequestConfig | Promise<RequestConfig>,\n    rejected?: (error: HttpError) => HttpError | Promise<HttpError>,\n  ): number {\n    return this.interceptors.request.use(fulfilled, rejected)\n  }\n\n  /**\n   * 添加响应拦截器\n   */\n  addResponseInterceptor<T = unknown>(\n    fulfilled: (response: ResponseData<T>) => ResponseData<T> | Promise<ResponseData<T>>,\n    rejected?: (error: HttpError) => HttpError | Promise<HttpError>,\n  ): number {\n    return this.interceptors.response.use(fulfilled as unknown as ResponseInterceptor, rejected)\n  }\n\n  /**\n   * 移除请求拦截器\n   */\n  removeRequestInterceptor(id: number): void {\n    this.interceptors.request.eject(id)\n  }\n\n  /**\n   * 移除响应拦截器\n   */\n  removeResponseInterceptor(id: number): void {\n    this.interceptors.response.eject(id)\n  }\n\n  /**\n   * 清空缓存\n   */\n  clearCache(): Promise<void> {\n    return this.cacheManager.clear()\n  }\n\n  /**\n   * 获取并发状态\n   */\n  getConcurrencyStatus() {\n    return this.concurrencyManager.getStatus()\n  }\n\n  /**\n   * 取消队列中的所有请求\n   */\n  cancelQueue(reason?: string): void {\n    this.concurrencyManager.cancelQueue(reason)\n  }\n\n  /**\n   * 处理请求拦截器\n   */\n  private async processRequestInterceptors(\n    config: RequestConfig,\n  ): Promise<RequestConfig> {\n    let processedConfig = config\n\n    const interceptors = (\n      this.interceptors.request as InterceptorManagerImpl<RequestInterceptor>\n    ).getInterceptors()\n\n    for (const interceptor of interceptors) {\n      try {\n        processedConfig = await interceptor.fulfilled(processedConfig)\n      }\n      catch (error) {\n        if (interceptor.rejected) {\n          throw await interceptor.rejected(error as HttpError)\n        }\n        throw error\n      }\n    }\n\n    return processedConfig\n  }\n\n  /**\n   * 处理响应拦截器\n   */\n  private async processResponseInterceptors<T>(\n    response: ResponseData<T>,\n  ): Promise<ResponseData<T>> {\n    let processedResponse = response as ResponseData<unknown>\n\n    const interceptors = (\n      this.interceptors.response as InterceptorManagerImpl<ResponseInterceptor>\n    ).getInterceptors()\n\n    for (const interceptor of interceptors) {\n      try {\n        processedResponse = await interceptor.fulfilled(processedResponse)\n      }\n      catch (error) {\n        if (interceptor.rejected) {\n          throw await interceptor.rejected(error as HttpError)\n        }\n        throw error\n      }\n    }\n\n    return processedResponse as ResponseData<T>\n  }\n\n  /**\n   * 处理错误拦截器\n   */\n  private async processErrorInterceptors(error: HttpError): Promise<HttpError> {\n    let processedError = error\n\n    const interceptors = (\n      this.interceptors.error as InterceptorManagerImpl<ErrorInterceptor>\n    ).getInterceptors()\n\n    for (const interceptor of interceptors) {\n      try {\n        processedError = await interceptor.fulfilled(processedError)\n      }\n      catch (err) {\n        processedError = err as HttpError\n      }\n    }\n\n    return processedError\n  }\n\n  // 移除对象池（现代JS引擎的对象创建已经很快，池化反而增加复杂度）\n\n  /**\n   * 优化的配置合并（简化版，去除对象池开销）\n   */\n  private optimizedMergeConfig(config: RequestConfig): RequestConfig {\n    // 如果请求配置为空，直接返回默认配置副本\n    if (!config || Object.keys(config).length === 0) {\n      return { ...this.config }\n    }\n\n    // 直接创建新对象（现代JS引擎优化很好）\n    const merged: RequestConfig = { ...this.config, ...config }\n\n    // 只有在两者都有 headers 时才进行深度合并\n    if (this.config?.headers && config.headers) {\n      merged.headers = { ...this.config.headers, ...config.headers }\n    }\n\n    // 只有在两者都有 params 时才进行深度合并\n    if (this.config?.params && config.params) {\n      merged.params = { ...this.config.params, ...config.params }\n    }\n\n    return merged\n  }\n\n\n  /**\n   * 上传文件\n   */\n  async upload<T = unknown>(\n    url: string,\n    file: File | File[],\n    config: UploadConfig = {},\n  ): Promise<UploadResult<T>> {\n    this.checkDestroyed()\n\n    const files = Array.isArray(file) ? file : [file]\n\n    if (files.length === 1) {\n      return this.uploadSingleFile<T>(url, files[0], config)\n    }\n    else {\n      return this.uploadMultipleFiles<T>(url, files, config)\n    }\n  }\n\n  /**\n   * 上传单个文件\n   */\n  private async uploadSingleFile<T = unknown>(\n    url: string,\n    file: File,\n    config: UploadConfig,\n  ): Promise<UploadResult<T>> {\n    // 使用静态导入的工具函数\n\n    // 验证文件\n    validateFile(file, config)\n\n    const startTime = Date.now()\n    const progressCalculator = new ProgressCalculator()\n\n    // 创建表单数据\n    const formData = createUploadFormData(file, config)\n\n    // 配置请求\n    const requestConfig: RequestConfig = {\n      method: 'POST',\n      url,\n      data: formData,\n      headers: {\n        ...(config.headers || {}),\n        // 不设置 Content-Type，让浏览器自动设置 multipart/form-data\n      },\n      ...(config || {}),\n      onUploadProgress: config.onProgress\n        ? (progressEvent: { loaded: number, total?: number }) => {\n            const progress = progressCalculator.calculate(\n              progressEvent.loaded,\n              progressEvent.total || 0,\n              file,\n            )\n            config.onProgress?.(progress)\n          }\n        : undefined,\n    }\n\n    const response = await this.request<T>(requestConfig)\n\n    return {\n      ...response,\n      file,\n      duration: Date.now() - startTime,\n    }\n  }\n\n  /**\n   * 上传多个文件\n   */\n  private async uploadMultipleFiles<T = unknown>(\n    url: string,\n    files: File[],\n    config: UploadConfig,\n  ): Promise<UploadResult<T>> {\n    // 使用静态导入的工具函数\n\n    // 验证所有文件\n    files.forEach(file => validateFile(file, config))\n\n    const startTime = Date.now()\n    const progressCalculator = new ProgressCalculator()\n\n    // 创建表单数据\n    const formData = new FormData()\n\n    // 添加所有文件\n    const fileField = config.fileField || 'files'\n    files.forEach((file, index) => {\n      formData.append(`${fileField}[${index}]`, file)\n    })\n\n    // 添加额外的表单数据\n    if (config.formData) {\n      Object.entries(config.formData).forEach(([key, value]) => {\n        formData.append(key, value)\n      })\n    }\n\n    // 配置请求\n    const requestConfig: RequestConfig = {\n      method: 'POST',\n      url,\n      data: formData,\n      headers: {\n        ...(config.headers || {}),\n      },\n      ...(config || {}),\n      onUploadProgress: config.onProgress\n        ? (progressEvent: { loaded: number, total?: number }) => {\n            const progress = progressCalculator.calculate(\n              progressEvent.loaded,\n              progressEvent.total || 0,\n            )\n            config.onProgress?.(progress)\n          }\n        : undefined,\n    }\n\n    const response = await this.request<T>(requestConfig)\n\n    return {\n      ...response,\n      file: files[0], // 返回第一个文件作为代表\n      duration: Date.now() - startTime,\n    }\n  }\n\n  /**\n   * 下载文件\n   */\n  async download(\n    url: string,\n    config: DownloadConfig = {},\n  ): Promise<DownloadResult> {\n    this.checkDestroyed()\n\n    // 使用静态导入的工具函数\n\n    const startTime = Date.now()\n    const progressCalculator = new DownloadProgressCalculator()\n\n    // 配置请求\n    const requestConfig: RequestConfig = {\n      method: 'GET',\n      url,\n      responseType: 'blob',\n      ...(config || {}),\n      onDownloadProgress: config.onProgress\n        ? (progressEvent: { loaded: number, total?: number }) => {\n            const progress = progressCalculator.calculate(\n              progressEvent.loaded,\n              progressEvent.total || 0,\n              config.filename,\n            )\n            config.onProgress?.(progress)\n          }\n        : undefined,\n    }\n\n    const response = await this.request<Blob>(requestConfig)\n\n    // 确定文件名\n    let filename = config.filename\n    if (!filename) {\n      filename = getFilenameFromResponse(response.headers)\n        || getFilenameFromURL(response.config.url || url)\n        || 'download'\n    }\n\n    // 确定文件类型\n    const type = response.data?.type || getMimeTypeFromFilename(filename)\n\n    // 自动保存文件（浏览器环境）\n    let downloadUrl: string | undefined\n    if (config.autoSave !== false && typeof window !== 'undefined') {\n      saveFileToLocal(response.data, filename)\n      downloadUrl = URL.createObjectURL(response.data)\n    }\n\n    return {\n      data: response.data,\n      filename,\n      size: response.data.size,\n      type,\n      duration: Date.now() - startTime,\n      url: downloadUrl,\n    }\n  }\n\n  /**\n   * 获取性能监控统计\n   */\n  getPerformanceStats() {\n    return this.monitor.getStats()\n  }\n\n  /**\n   * 获取最近的请求指标\n   */\n  getRecentMetrics(count?: number) {\n    return this.monitor.getRecentMetrics(count)\n  }\n\n  /**\n   * 获取慢请求列表\n   */\n  getSlowRequests() {\n    return this.monitor.getSlowRequests()\n  }\n\n  /**\n   * 获取失败请求列表\n   */\n  getFailedRequests() {\n    return this.monitor.getFailedRequests()\n  }\n\n  /**\n   * 启用性能监控\n   */\n  enableMonitoring() {\n    this.monitor.enable()\n  }\n\n  /**\n   * 禁用性能监控\n   */\n  disableMonitoring() {\n    this.monitor.disable()\n  }\n\n  /**\n   * 获取优先级队列统计\n   */\n  getPriorityQueueStats() {\n    return this.priorityQueue.getStats()\n  }\n\n  /**\n   * 获取连接池统计\n   */\n  getConnectionPoolStats() {\n    return this.requestPool.getStats()\n  }\n\n  /**\n   * 获取连接池详情\n   */\n  getConnectionDetails() {\n    return this.requestPool.getConnectionDetails()\n  }\n\n  /**\n   * 导出性能指标\n   */\n  exportMetrics() {\n    return {\n      performance: this.monitor.exportMetrics(),\n      priorityQueue: this.priorityQueue.getStats(),\n      connectionPool: this.requestPool.getStats(),\n      concurrency: this.concurrencyManager.getStatus(),\n      cache: this.cacheManager.getStats ? this.cacheManager.getStats() : null,\n    }\n  }\n\n  /**\n   * 设置请求优先级\n   */\n  setPriority(config: RequestConfig, priority: Priority): RequestConfig {\n    return {\n      ...config,\n      priority,\n    }\n  }\n\n  /**\n   * 销毁客户端，清理资源\n   */\n  destroy(): void {\n    if (this.isDestroyed) {\n      return\n    }\n\n    this.isDestroyed = true\n\n    // 取消所有进行中的请求\n    this.cancelManager.cancelAll('Client destroyed')\n\n    // 清理缓存\n    this.cacheManager.clear()\n\n    // 清理并发队列\n    this.concurrencyManager.cancelQueue('Client destroyed')\n\n    // 清理优先级队列\n    this.priorityQueue.destroy()\n\n    // 清理连接池\n    this.requestPool.destroy()\n\n    // 清理监控器\n    this.monitor.clear()\n\n    // 清理拦截器\n    this.interceptors.request.clear()\n    this.interceptors.response.clear()\n    this.interceptors.error.clear()\n    \n    // 清理缓存管理器的定时器\n    const cacheManager = this.cacheManager as unknown as { destroy?: () => void }\n    if (cacheManager && typeof cacheManager.destroy === 'function') {\n      cacheManager.destroy()\n    }\n    \n    // 解除循环引用（使用 null! 避免在 destroy 后使用的编译错误）\n    this.adapter = null!\n    this.retryManager = null!\n    this.cancelManager = null!\n    this.cacheManager = null!\n    this.concurrencyManager = null!\n    this.monitor = null!\n    this.priorityQueue = null!\n    this.requestPool = null!\n  }\n\n  /**\n   * 检查客户端是否已销毁\n   */\n  private checkDestroyed(): void {\n    if (this.isDestroyed) {\n      throw new Error('HttpClient has been destroyed')\n    }\n  }\n}\n"],"names":["HttpClientImpl","constructor","config","adapter","this","isDestroyed","timeout","headers","Error","retryManager","RetryManager","retry","cancelManager","globalCancelManager","cacheManager","CacheManager","cache","concurrencyManager","ConcurrencyManager","concurrency","monitor","RequestMonitor","priorityQueue","PriorityQueue","requestPool","RequestPool","connectionPool","interceptors","request","InterceptorManagerImpl","response","error","checkDestroyed","mergedConfig","optimizedMergeConfig","requestId","generateId","startRequest","priority","determinePriority","enqueue","async","executeRequestWithRetry","endRequest","retryConfig","retries","executeWithRetry","recordRetry","executeRequest","get","execute","performRequest","processedConfig","processRequestInterceptors","processResponseInterceptors","set","processErrorInterceptors","url","method","post","data","put","patch","head","options","cancelAll","reason","getActiveRequestCount","updateRetryConfig","updateConfig","setConfig","getConfig","addRequestInterceptor","fulfilled","rejected","use","addResponseInterceptor","removeRequestInterceptor","id","eject","removeResponseInterceptor","clearCache","clear","getConcurrencyStatus","getStatus","cancelQueue","getInterceptors","interceptor","processedResponse","processedError","err","Object","keys","length","merged","params","upload","file","files","Array","isArray","uploadSingleFile","uploadMultipleFiles","validateFile","startTime","Date","now","progressCalculator","ProgressCalculator","requestConfig","createUploadFormData","onUploadProgress","onProgress","progressEvent","progress","calculate","loaded","total","duration","forEach","formData","FormData","fileField","index","append","entries","key","value","download","DownloadProgressCalculator","responseType","onDownloadProgress","filename","getFilenameFromResponse","getFilenameFromURL","type","getMimeTypeFromFilename","downloadUrl","autoSave","window","saveFileToLocal","URL","createObjectURL","size","getPerformanceStats","getStats","getRecentMetrics","count","getSlowRequests","getFailedRequests","enableMonitoring","enable","disableMonitoring","disable","getPriorityQueueStats","getConnectionPoolStats","getConnectionDetails","exportMetrics","performance","setPriority","destroy","Q"],"mappings":"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"}