{"version":3,"file":"debugger.cjs","sources":["../../src/utils/debugger.ts"],"sourcesContent":["import type { HttpClient, HttpError, RequestConfig, ResponseData } from '../types'\n\n/**\n * 调试日志级别\n */\nexport enum DebugLevel {\n  NONE = 0,\n  ERROR = 1,\n  WARN = 2,\n  INFO = 3,\n  DEBUG = 4,\n  TRACE = 5,\n}\n\n/**\n * 请求日志\n */\nexport interface RequestLog {\n  /** 请求 ID */\n  id: string\n  /** 请求配置 */\n  config: RequestConfig\n  /** 请求时间 */\n  timestamp: number\n  /** 请求方法 */\n  method: string\n  /** 请求 URL */\n  url: string\n  /** 请求头 */\n  headers?: Record<string, string>\n  /** 请求数据 */\n  data?: any\n}\n\n/**\n * 响应日志\n */\nexport interface ResponseLog {\n  /** 请求 ID */\n  requestId: string\n  /** 响应数据 */\n  response?: ResponseData\n  /** 错误信息 */\n  error?: HttpError\n  /** 响应时间 */\n  timestamp: number\n  /** 耗时（毫秒） */\n  duration: number\n  /** 状态码 */\n  status?: number\n  /** 响应大小（字节） */\n  size?: number\n}\n\n/**\n * 调试事件\n */\nexport interface DebugEvent {\n  /** 事件类型 */\n  type: 'request' | 'response' | 'error' | 'cache_hit' | 'cache_miss' | 'retry' | 'custom'\n  /** 事件数据 */\n  data: any\n  /** 事件时间 */\n  timestamp: number\n  /** 事件级别 */\n  level: DebugLevel\n}\n\n/**\n * 调试器配置\n */\nexport interface DebuggerConfig {\n  /** 调试级别 */\n  level?: DebugLevel\n  /** 是否记录请求 */\n  logRequests?: boolean\n  /** 是否记录响应 */\n  logResponses?: boolean\n  /** 是否记录请求头 */\n  logHeaders?: boolean\n  /** 是否记录请求体 */\n  logBody?: boolean\n  /** 是否记录响应体 */\n  logResponseBody?: boolean\n  /** 最大日志数量 */\n  maxLogs?: number\n  /** 是否在控制台输出 */\n  console?: boolean\n  /** 自定义日志处理器 */\n  handler?: (event: DebugEvent) => void\n  /** 是否记录性能指标 */\n  performance?: boolean\n  /** 是否记录缓存命中 */\n  cacheTracking?: boolean\n}\n\n/**\n * 性能指标\n */\nexport interface PerformanceMetrics {\n  /** DNS 查询时间 */\n  dnsTime?: number\n  /** TCP 连接时间 */\n  tcpTime?: number\n  /** TLS 握手时间 */\n  tlsTime?: number\n  /** 请求时间 */\n  requestTime?: number\n  /** 响应时间 */\n  responseTime?: number\n  /** 总时间 */\n  totalTime: number\n  /** 请求大小 */\n  requestSize?: number\n  /** 响应大小 */\n  responseSize?: number\n}\n\n/**\n * HTTP 调试器\n *\n * 提供详细的请求日志、性能分析和调试功能\n *\n * @example\n * ```typescript\n * const  = new HttpDebugger({\n *   level: DebugLevel.DEBUG,\n *   logRequests: true,\n *   logResponses: true,\n *   performance: true,\n * })\n *\n * // 应用到客户端\n * .apply(httpClient)\n *\n * // 获取日志\n * const logs = .getLogs()\n *\n * // 获取性能报告\n * const report = .getPerformanceReport()\n *\n * // 导出日志\n * const exported = .exportLogs()\n * ```\n */\nexport class HttpDebugger {\n  private config: Required<DebuggerConfig>\n  private requestLogs: Map<string, RequestLog> = new Map()\n  private responseLogs: ResponseLog[] = []\n  private events: DebugEvent[] = []\n  private performanceData: Map<string, PerformanceMetrics> = new Map()\n  private isApplied = false\n\n  constructor(config: DebuggerConfig = {}) {\n    this.config = {\n      level: config.level ?? DebugLevel.INFO,\n      logRequests: config.logRequests ?? true,\n      logResponses: config.logResponses ?? true,\n      logHeaders: config.logHeaders ?? true,\n      logBody: config.logBody ?? false,\n      logResponseBody: config.logResponseBody ?? false,\n      maxLogs: config.maxLogs ?? 1000,\n      console: config.console ?? true,\n      handler: config.handler || (() => {}),\n      performance: config.performance ?? true,\n      cacheTracking: config.cacheTracking ?? true,\n    } as Required<DebuggerConfig>\n  }\n\n  /**\n   * 应用到 HTTP 客户端\n   */\n  apply(client: HttpClient): void {\n    if (this.isApplied) {\n      throw new Error('HttpDebugger is already applied')\n    }\n\n    // 添加请求拦截器\n    client.interceptors.request.use((config) => {\n      this.logRequest(config)\n      return config\n    })\n\n    // 添加响应拦截器\n    client.interceptors.response.use(\n      (response) => {\n        this.logResponse(response)\n        return response\n      },\n      (error) => {\n        this.logError(error)\n        return Promise.reject(error)\n      },\n    )\n\n    this.isApplied = true\n  }\n\n  /**\n   * 记录请求\n   */\n  private logRequest(config: RequestConfig): void {\n    if (!this.config?.logRequests) {\n      return\n    }\n\n    const id = this.generateId()\n    const log: RequestLog = {\n      id,\n      config,\n      timestamp: Date.now(),\n      method: config.method || 'GET',\n      url: config.url || '',\n      headers: this.config?.logHeaders ? config.headers : undefined,\n      data: this.config?.logBody ? config.data : undefined,\n    }\n\n    this.requestLogs.set(id, log)\n\n    // 开始性能计时\n    if (this.config?.performance) {\n      this.performanceData.set(id, {\n        totalTime: 0,\n      })\n    }\n\n    // 记录事件\n    this.recordEvent({\n      type: 'request',\n      data: log,\n      timestamp: Date.now(),\n      level: DebugLevel.DEBUG,\n    })\n\n    // 控制台输出\n    if (this.config?.console && this.config?.level >= DebugLevel.DEBUG) {\n      console.debug(`[HTTP Request] ${config.method} ${config.url}`, log)\n    }\n  }\n\n  /**\n   * 记录响应\n   */\n  private logResponse(response: ResponseData): void {\n    if (!this.config?.logResponses) {\n      return\n    }\n\n    const requestId = this.findRequestId(response.config)\n    const requestLog = requestId ? this.requestLogs.get(requestId) : null\n    const timestamp = Date.now()\n    const duration = requestLog ? timestamp - requestLog.timestamp : 0\n\n    const log: ResponseLog = {\n      requestId: requestId || 'unknown',\n      response: this.config?.logResponseBody ? response : {\n        ...response,\n        data: '[Response Body Hidden]',\n      },\n      timestamp,\n      duration,\n      status: response.status,\n      size: this.estimateSize(response.data),\n    }\n\n    this.responseLogs.push(log)\n    this.trimLogs()\n\n    // 更新性能数据\n    if (this.config?.performance && requestId) {\n      const metrics = this.performanceData.get(requestId)\n      if (metrics) {\n        metrics.totalTime = duration\n        metrics.responseSize = log.size\n      }\n    }\n\n    // 记录事件\n    this.recordEvent({\n      type: 'response',\n      data: log,\n      timestamp,\n      level: DebugLevel.DEBUG,\n    })\n\n    // 控制台输出\n    if (this.config?.console && this.config?.level >= DebugLevel.DEBUG) {\n      console.debug(`[HTTP Response] ${response.config.method} ${response.config.url} - ${response.status} (${duration}ms)`, log)\n    }\n  }\n\n  /**\n   * 记录错误\n   */\n  private logError(error: HttpError): void {\n    const requestId = error.config ? this.findRequestId(error.config) : null\n    const requestLog = requestId ? this.requestLogs.get(requestId) : null\n    const timestamp = Date.now()\n    const duration = requestLog ? timestamp - requestLog.timestamp : 0\n\n    const log: ResponseLog = {\n      requestId: requestId || 'unknown',\n      error,\n      timestamp,\n      duration,\n      status: error.response?.status,\n    }\n\n    this.responseLogs.push(log)\n    this.trimLogs()\n\n    // 记录事件\n    this.recordEvent({\n      type: 'error',\n      data: log,\n      timestamp,\n      level: DebugLevel.ERROR,\n    })\n\n    // 控制台输出\n    if (this.config?.console && this.config?.level >= DebugLevel.ERROR) {\n      console.error(\n        `[HTTP Error] ${error.config?.method} ${error.config?.url} - ${error.message} (${duration}ms)`,\n        log,\n      )\n    }\n  }\n\n  /**\n   * 记录事件\n   */\n  recordEvent(event: DebugEvent): void {\n    this.events.push(event)\n\n    // 限制事件数量\n    if (this.events.length > this.config?.maxLogs) {\n      this.events.shift()\n    }\n\n    // 调用自定义处理器\n    this.config?.handler(event)\n  }\n\n  /**\n   * 获取所有请求日志\n   */\n  getRequestLogs(): RequestLog[] {\n    return Array.from(this.requestLogs.values())\n  }\n\n  /**\n   * 获取所有响应日志\n   */\n  getResponseLogs(): ResponseLog[] {\n    return [...this.responseLogs]\n  }\n\n  /**\n   * 获取所有事件\n   */\n  getEvents(): DebugEvent[] {\n    return [...this.events]\n  }\n\n  /**\n   * 获取性能报告\n   */\n  getPerformanceReport(): {\n    totalRequests: number\n    averageDuration: number\n    slowestRequest: ResponseLog | null\n    fastestRequest: ResponseLog | null\n    errorRate: number\n    totalDataTransferred: number\n  } {\n    const logs = this.responseLogs\n    const totalRequests = logs.length\n    const totalDuration = logs.reduce((sum, log) => sum + log.duration, 0)\n    const averageDuration = totalRequests > 0 ? totalDuration / totalRequests : 0\n\n    const slowestRequest = logs.reduce((slowest, log) =>\n      log.duration > (slowest?.duration || 0) ? log : slowest, logs[0] || null)\n\n    const fastestRequest = logs.reduce((fastest, log) =>\n      log.duration < (fastest?.duration || Number.POSITIVE_INFINITY) ? log : fastest, logs[0] || null)\n\n    const errors = logs.filter(log => log.error).length\n    const errorRate = totalRequests > 0 ? errors / totalRequests : 0\n\n    const totalDataTransferred = logs.reduce((sum, log) => sum + (log.size || 0), 0)\n\n    return {\n      totalRequests,\n      averageDuration,\n      slowestRequest,\n      fastestRequest,\n      errorRate,\n      totalDataTransferred,\n    }\n  }\n\n  /**\n   * 清空日志\n   */\n  clearLogs(): void {\n    this.requestLogs.clear()\n    this.responseLogs = []\n    this.events = []\n    this.performanceData.clear()\n  }\n\n  /**\n   * 导出日志\n   */\n  exportLogs(): string {\n    return JSON.stringify({\n      requests: this.getRequestLogs(),\n      responses: this.getResponseLogs(),\n      events: this.getEvents(),\n      performance: this.getPerformanceReport(),\n      timestamp: Date.now(),\n    }, null, 2)\n  }\n\n  /**\n   * 更新配置\n   */\n  updateConfig(config: Partial<DebuggerConfig>): void {\n    Object.assign(this.config, config)\n  }\n\n  /**\n   * 获取配置\n   */\n  getConfig(): DebuggerConfig {\n    return { ...this.config }\n  }\n\n  /**\n   * 生成唯一 ID\n   */\n  private generateId(): string {\n    return `${Date.now()}-${Math.random().toString(36).slice(2, 11)}`\n  }\n\n  /**\n   * 查找请求 ID\n   */\n  private findRequestId(config: RequestConfig): string | null {\n    for (const [id, log] of this.requestLogs.entries()) {\n      if (log.config === config) {\n        return id\n      }\n    }\n    return null\n  }\n\n  /**\n   * 估算数据大小\n   */\n  private estimateSize(data: any): number {\n    if (!data) {\n      return 0\n    }\n\n    if (typeof data === 'string') {\n      return data.length\n    }\n\n    if (data instanceof Blob) {\n      return data.size\n    }\n\n    if (data instanceof ArrayBuffer) {\n      return data.byteLength\n    }\n\n    // JSON 序列化估算\n    try {\n      return JSON.stringify(data).length\n    }\n    catch {\n      return 0\n    }\n  }\n\n  /**\n   * 修剪日志\n   */\n  private trimLogs(): void {\n    if (this.responseLogs.length > this.config?.maxLogs) {\n      this.responseLogs = this.responseLogs.slice(-this.config?.maxLogs)\n    }\n\n    if (this.requestLogs.size > this.config?.maxLogs) {\n      const excess = this.requestLogs.size - this.config?.maxLogs\n      const keys = Array.from(this.requestLogs.keys())\n      for (let i = 0; i < excess; i++) {\n        this.requestLogs.delete(keys[i])\n      }\n    }\n  }\n}\n\n/**\n * 创建 HTTP 调试器\n */\nexport function createHttpDebugger(config?: DebuggerConfig): HttpDebugger {\n  return new HttpDebugger(config)\n}\n\n/**\n * 创建调试拦截器\n */\nexport function createDebugInterceptor(config?: DebuggerConfig) {\n  const httpDebugger = new HttpDebugger(config)\n\n  return {\n    request: (config: RequestConfig) => {\n      httpDebugger.recordEvent({\n        type: 'request',\n        data: config,\n        timestamp: Date.now(),\n        level: DebugLevel.DEBUG,\n      })\n      return config\n    },\n    response: (response: ResponseData) => {\n      httpDebugger.recordEvent({\n        type: 'response',\n        data: response,\n        timestamp: Date.now(),\n        level: DebugLevel.DEBUG,\n      })\n      return response\n    },\n    error: (error: HttpError) => {\n      httpDebugger.recordEvent({\n        type: 'error',\n        data: error,\n        timestamp: Date.now(),\n        level: DebugLevel.ERROR,\n      })\n      return Promise.reject(error)\n    },\n    debugger: httpDebugger,\n  }\n}\n"],"names":["DebugLevel","NONE","ERROR","WARN","INFO","DEBUG","TRACE","HttpDebugger","constructor","config","this","requestLogs","Map","responseLogs","events","performanceData","isApplied","level","logRequests","logResponses","logHeaders","logBody","logResponseBody","maxLogs","console","handler","performance","cacheTracking","apply","client","Error","interceptors","request","use","logRequest","response","logResponse","error","logError","Promise","reject","id","generateId","log","timestamp","Date","now","method","url","headers","data","set","totalTime","recordEvent","type","requestId","findRequestId","requestLog","get","duration","status","size","estimateSize","push","trimLogs","metrics","responseSize","event","length","shift","getRequestLogs","Array","from","values","getResponseLogs","getEvents","getPerformanceReport","logs","totalRequests","totalDuration","reduce","sum","averageDuration","slowestRequest","slowest","fastestRequest","fastest","Number","POSITIVE_INFINITY","errors","filter","errorRate","totalDataTransferred","clearLogs","clear","exportLogs","JSON","stringify","requests","responses","updateConfig","Object","assign","getConfig","Math","random","toString","slice","entries","Blob","ArrayBuffer","byteLength","excess","keys","i","delete","httpDebugger","debugger"],"mappings":"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"}