"use strict";var e=require("./batch.cjs"),r=require("./helpers.cjs"),t=require("./memory.cjs"),o=require("./offline.cjs"),n=require("./signature.cjs"),s=require("./warmup.cjs");const a=new Map;function i(e){if(e.length<=20){const r=a.get(e);if(void 0!==r)return r;const t=encodeURIComponent(e).replace(/%20/g,"+");return a.size<1e3&&a.set(e,t),t}return encodeURIComponent(e).replace(/%20/g,"+")}function c(e){if(!e||"object"!=typeof e)return"";const r=Object.keys(e);if(0===r.length)return"";const t=Array.from({length:2*r.length});let o=0;for(const n of r){const r=e[n];if(null==r)continue;const s=i(n);if(Array.isArray(r)){const e=r.length;for(let n=0;n<e;n++){const e=r[n];null!=e&&(t[o++]=`${s}=${i(String(e))}`)}}else t[o++]=`${s}=${i(String(r))}`}return t.slice(0,o).join("&")}function u(e){return/^(?:[a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function p(e,r){return r?`${e.replace(/\/+$/,"")}/${r.replace(/^\/+/,"")}`:e}const l={isSuccess:e=>e>=200&&e<300,isRedirect:e=>e>=300&&e<400,isClientError:e=>e>=400&&e<500,isServerError:e=>e>=500,isAuthError:e=>401===e||403===e,isNotFound:e=>404===e,isTimeout:e=>408===e},f={isNetworkError:e=>e?.isNetworkError||"NetworkError"===e?.name||"NETWORK_ERROR"===e?.code||!e?.response&&e?.message?.includes("network"),isTimeoutError:e=>e?.isTimeoutError||"TimeoutError"===e?.name||"TIMEOUT"===e?.code||e?.message?.includes("timeout"),isCancelError:e=>e?.isCancelError||"AbortError"===e?.name||"CANCELED"===e?.code||e?.message?.includes("aborted"),getErrorType:e=>{if(f.isNetworkError(e))return"network";if(f.isTimeoutError(e))return"timeout";if(f.isCancelError(e))return"cancel";if(e?.response?.status){const r=e.response.status;if(l.isClientError(r))return"client";if(l.isServerError(r))return"server"}return"unknown"},getUserFriendlyMessage:e=>{const r=f.getErrorType(e),t={network:"网络连接失败，请检查网络设置",timeout:"请求超时，请重试",cancel:"请求已取消",client:`请求失败 (${e?.response?.status||"客户端错误"})`,server:"服务器内部错误，请稍后重试",unknown:"未知错误，请重试"};return t[r]||t.unknown}};exports.BatchManager=e.BatchManager,exports.createBatchManager=e.createBatchManager,exports.createBatchRequest=r.createBatchRequest,exports.createChainBuilder=r.createChainBuilder,exports.debounce=r.debounce,exports.deepFreeze=r.deepFreeze,exports.get=r.get,exports.memoize=r.memoize,exports.once=r.once,exports.parallelLimit=r.parallelLimit,exports.retry=r.retry,exports.set=r.set,exports.sleep=r.sleep,exports.throttle=r.throttle,exports.timeout=r.timeout,exports.MemoryCleaner=t.MemoryCleaner,exports.MemoryMonitor=t.MemoryMonitor,exports.createMemoryMonitor=t.createMemoryMonitor,exports.globalMemoryCleaner=t.globalMemoryCleaner,exports.globalMemoryMonitor=t.globalMemoryMonitor,exports.OfflineQueueManager=o.OfflineQueueManager,exports.createOfflineQueueManager=o.createOfflineQueueManager,exports.SignatureManager=n.SignatureManager,exports.createSignatureInterceptor=n.createSignatureInterceptor,exports.createSignatureManager=n.createSignatureManager,exports.KeepAliveManager=s.KeepAliveManager,exports.WarmupManager=s.WarmupManager,exports.createKeepAliveManager=s.createKeepAliveManager,exports.createWarmupManager=s.createWarmupManager,exports.warmupConnections=s.warmupConnections,exports.ErrorClassifier=f,exports.HttpStatus=l,exports.buildQueryString=c,exports.buildURL=function(e,r,t){let o=e;if(r&&!u(e)&&(o=p(r,e)),t&&Object.keys(t).length>0){const e=c(t);if(e){const r=o.includes("?")?"&":"?";o+=r+e}}return o},exports.clearQueryStringCache=function(){a.clear()},exports.combineURLs=p,exports.createHttpError=function(e,r,t,o){const n=new Error(e);return n.config=r,n.code=t,n.response=o,n.isNetworkError=!1,n.isTimeoutError=!1,n.isCancelError=!1,"ECONNABORTED"===t||e.includes("timeout")?n.isTimeoutError=!0:"NETWORK_ERROR"===t||e.includes("Network Error")?n.isNetworkError=!0:("CANCELED"===t||e.includes("canceled"))&&(n.isCancelError=!0),n},exports.deepClone=function e(r){if(null===r||"object"!=typeof r)return r;if(r instanceof Date)return new Date(r.getTime());if(Array.isArray(r))return r.map(r=>e(r));if("object"==typeof r){const t={};for(const o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=e(r[o]));return t}return r},exports.delay=function(e){return new Promise(r=>setTimeout(r,e))},exports.generateId=function(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)},exports.isAbsoluteURL=u,exports.isArrayBuffer=function(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer},exports.isBlob=function(e){return typeof Blob<"u"&&e instanceof Blob},exports.isFormData=function(e){return typeof FormData<"u"&&e instanceof FormData},exports.isURLSearchParams=function(e){return typeof URLSearchParams<"u"&&e instanceof URLSearchParams},exports.mergeConfig=function(e,r={}){if(!e||"object"!=typeof e)throw new TypeError("defaultConfig must be a valid object");if(!r||"object"!=typeof r||0===Object.keys(r).length)return{...e};const t={...e,...r};return e.headers&&r.headers&&(t.headers={...e.headers,...r.headers}),e.params&&r.params&&(t.params={...e.params,...r.params}),t};
//# sourceMappingURL=index.cjs.map
