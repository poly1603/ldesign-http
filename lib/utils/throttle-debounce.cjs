"use strict";function t(t,n,e={}){const{leading:l=!1,trailing:i=!0,maxWait:u}=e;let c,o=null,s=null,a=null,r=0,h=null,m=null;function f(n){const e=h,l=m;h=null,m=null,r=n;const i=t.apply(l,e);return c=i,i}function x(t){const e=t-(a??0);return null===a||e>=n||e<0||void 0!==u&&t-r>=u}function p(){const t=Date.now();x(t)?g(t):o=setTimeout(p,function(t){const e=t-r,l=n-(t-(a??0));return void 0!==u?Math.min(l,u-e):l}(t))}function g(t){o=null,i&&h?c=f(t):(h=null,m=null)}const d=function t(...e){const i=Date.now(),g=x(i);return h=e,m=t,a=i,g?(null===o&&function(t){r=t,o=setTimeout(p,n),l&&(c=f(t))}(a),void 0!==u&&(null!==s&&clearTimeout(s),s=setTimeout(p,u)),c):(null===o&&(o=setTimeout(p,n)),c)};return d.cancel=function(){null!==o&&clearTimeout(o),null!==s&&clearTimeout(s),r=0,h=null,a=null,m=null,o=null,s=null},d.flush=function(){return null===o||g(Date.now()),c},d.pending=function(){return null!==o},d}class n{constructor(t,n){this.maxCalls=t,this.timeWindow=n,this.calls=[]}canExecute(){return this.cleanup(),this.calls.length<this.maxCalls}recordExecution(){this.calls.push(Date.now())}execute(t){if(this.canExecute())return this.recordExecution(),t()}getNextAvailableTime(){if(this.cleanup(),this.calls.length<this.maxCalls)return Date.now();const t=this.calls[0];return t?t+this.timeWindow:null}cleanup(){const t=Date.now();this.calls=this.calls.filter(n=>t-n<this.timeWindow)}reset(){this.calls=[]}getCurrentCalls(){return this.cleanup(),this.calls.length}getRemainingCalls(){return this.cleanup(),Math.max(0,this.maxCalls-this.calls.length)}}exports.RateLimiter=n,exports.createAdaptiveDebounce=function(t,n={}){const{minDelay:e=100,maxDelay:l=1e3,factor:i=1.5}=n;let u=e,c=0,o=null,s=0;function a(){null!==o&&(clearTimeout(o),o=null)}const r=function(...n){(function(){const t=Date.now();t-c<2*u?(u=Math.min(u*i,l),s++):s>0&&(u=Math.max(u/i,e),s=Math.max(0,s-1)),c=t})(),a(),o=setTimeout(()=>{t.apply(this,n),o=null},u)};return r.cancel=a,r.reset=function(){a(),u=e,c=0,s=0},r},exports.createRateLimitedFunction=function(t,e,l,i={}){const u=new n(e,l),c=[],{onLimit:o,queueOverflow:s="drop"}=i;function a(){for(;c.length>0&&u.canExecute();){const t=c.shift();t&&(u.recordExecution(),t())}if(c.length>0){const t=u.getNextAvailableTime();if(t){const n=Math.max(0,t-Date.now());setTimeout(a,n)}}}const r=function(...n){const l=()=>t.apply(this,n);u.canExecute()?(u.recordExecution(),l()):(o?.(),"replace"===s&&c.length>=e&&c.shift(),("drop"!==s||c.length<e)&&(c.push(l),a()))};return r.limiter=u,r.queue=c,r},exports.debounce=t,exports.throttle=function(n,e,l={}){const{leading:i=!0,trailing:u=!0}=l;return t(n,e,{leading:i,trailing:u,maxWait:e})};
//# sourceMappingURL=throttle-debounce.cjs.map
