"use strict";var e=require("vue");exports.useRequestQueue=function(u,a={}){const{concurrency:t=6,autoStart:l=!0,timeout:r=3e4}=a,c=e.ref([]),n=e.ref(new Set),o=e.ref(0),i=e.ref(0),v=e.ref(!l),s=e.computed(()=>c.value.length),d=e.computed(()=>n.value.size),f=e.computed(()=>o.value+i.value+s.value+d.value),p=async e=>{try{if(Date.now()-e.createdAt>r)throw new Error("Request timeout in queue");const a=await u.request(e.config);e.resolve(a.data),o.value++}catch(u){e.reject(u),i.value++}finally{n.value.delete(e.id),v.value||m()}};async function m(){for(;!v.value&&c.value.length>0&&n.value.size<t;){const e=c.value.shift();if(!e)break;n.value.add(e.id),p(e).catch(()=>{})}}return{enqueue:(e,u=0)=>new Promise((a,t)=>{const l={id:`${Date.now()}-${Math.random()}`,config:e,priority:u,resolve:a,reject:t,createdAt:Date.now()},r=c.value.findIndex(e=>e.priority<u);-1===r?c.value.push(l):c.value.splice(r,0,l),v.value||setTimeout(()=>m(),0)}),pause:()=>{v.value=!0},resume:()=>{v.value=!1,m()},clear:()=>{c.value.forEach(e=>{e.reject(new Error("Queue cleared"))}),c.value=[]},cancelAll:()=>{u.cancelAll("Queue cancelled"),n.value.clear()},reset:()=>{o.value=0,i.value=0},pending:s,active:d,total:f,completed:o,failed:i,isPaused:v,queue:c,activeRequests:n}};
//# sourceMappingURL=useRequestQueue.cjs.map
