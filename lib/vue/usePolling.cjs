"use strict";var e=require("vue"),n=require("../factory.cjs");function t(t,i){const o=i.client||n.createHttpClient(),l=e.ref(null),u=e.ref(!1),a=e.ref(null),r=e.ref(!1),s=e.ref(0);let d=null,c=!0,v=!0;function f(){d&&clearTimeout(d),d=setTimeout(w,i.interval)}const m=()=>{r.value=!1,d&&(clearTimeout(d),d=null)};async function p(){try{u.value=!0,a.value=null;const e=await o.request(t);return l.value=e.data,s.value++,i.onSuccess?.(e.data),i.stopWhen?.(e.data)&&m(),i.maxPolls&&s.value>=i.maxPolls&&m(),e.data}catch(e){const n=e;return a.value=n,i.onError?.(n),i.stopOnError&&m(),null}finally{u.value=!1}}async function w(){if(r.value){if(i.pauseWhenHidden&&!c)return void f();if(i.pauseWhenOffline&&!v)return void f();await p(),r.value&&f()}}function h(){r.value||(r.value=!0,s.value=0,!1!==i.immediate?w():f())}if(i.pauseWhenHidden&&typeof document<"u"){const n=()=>{c=!document.hidden};document.addEventListener("visibilitychange",n),e.onUnmounted(()=>{document.removeEventListener("visibilitychange",n)})}if(i.pauseWhenOffline&&typeof window<"u"){const n=()=>{v=!0},t=()=>{v=!1};window.addEventListener("online",n),window.addEventListener("offline",t),e.onUnmounted(()=>{window.removeEventListener("online",n),window.removeEventListener("offline",t)})}return e.onUnmounted(()=>{m()}),!1!==i.immediate&&h(),{data:l,loading:u,error:a,isPolling:r,pollCount:s,start:h,stop:m,restart:function(){m(),h()},execute:p}}exports.usePolling=t,exports.usePollingTimes=function(e,n,i=3e3){return t(e,{interval:i,maxPolls:n,immediate:!0})},exports.usePollingUntil=function(e,n,i=3e3){return t(e,{interval:i,stopWhen:n,immediate:!0})};
//# sourceMappingURL=usePolling.cjs.map
