"use strict";var e=require("vue"),r=require("../factory.cjs");exports.useForm=function(t={}){const a=r.createHttpClient(t.clientConfig),n=e.reactive({...t.initialData}),l=e.ref(!1),i=e.ref(null),u=e.ref({}),o=e.ref({}),s=e.computed(()=>null!==i.value),v=e.computed(()=>Object.keys(u.value).length>0),c=e.computed(()=>s.value||v.value),d=e.computed(()=>!v.value);let m=null;const g=e=>{const r=o.value[e];if(!r||0===r.length)return!0;const t=n[e];for(const a of r){if(a.required&&(null==t||""===t))return u.value[e]=a.message||`${String(e)} is required`,!1;if(null!=t&&""!==t){if(void 0!==a.min&&String(t).length<a.min)return u.value[e]=a.message||`${String(e)} must be at least ${a.min} characters`,!1;if(void 0!==a.max&&String(t).length>a.max)return u.value[e]=a.message||`${String(e)} must be at most ${a.max} characters`,!1;if(a.pattern&&!a.pattern.test(String(t)))return u.value[e]=a.message||`${String(e)} format is invalid`,!1;if(a.validator){const r=a.validator(t);if(!0!==r)return u.value[e]="string"==typeof r?r:a.message||`${String(e)} is invalid`,!1}}}return delete u.value[e],!0},f=()=>{let e=!0;for(const r in o.value)g(r)||(e=!1);return!e&&t.onValidationError&&t.onValidationError(u.value),e};return!1!==t.cancelOnUnmount&&e.onUnmounted(()=>{m&&m.abort()}),{data:n,submitting:l,error:i,errors:u,hasError:s,hasValidationErrors:v,hasAnyError:c,isValid:d,submit:async(e,r)=>{try{if(l.value=!0,i.value=null,!f())return null;m&&m.abort(),m=new AbortController;const u={...r,signal:m.signal},o=await a.post(e,n,u);return t.onSuccess?.(o.data,o),o.data}catch(e){const r=e;throw"AbortError"!==r.name&&(i.value=r,t.onError?.(r)),r}finally{l.value=!1}},validate:f,validateField:g,reset:()=>{Object.assign(n,t.initialData||{}),l.value=!1,i.value=null,u.value={}},clearErrors:()=>{i.value=null},clearValidationErrors:()=>{u.value={}},setField:(e,r)=>{n[e]=r,o.value[e]&&g(e)},setFieldError:(e,r)=>{u.value[e]=r},setValidationRules:e=>{o.value=e}}};
//# sourceMappingURL=useForm.cjs.map
